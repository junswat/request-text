const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser--JSpWAzP.js","assets/vendor-B6OWX3Rw.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,R as r,g as n,c as s}from"./vendor-B6OWX3Rw.js";import{P as i,G as o,T as a,S as l,C as c,a as u,A as d,b as h,F as f,K as p,L as g}from"./ui-DJ-PU0yg.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var m={exports:{}},v={},y=e,b=Symbol.for("react.element"),w=Symbol.for("react.fragment"),_=Object.prototype.hasOwnProperty,x=y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,k={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var n,s={},i=null,o=null;for(n in void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(o=t.ref),t)_.call(t,n)&&!k.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:b,type:e,key:i,ref:o,props:s,_owner:x.current}}v.Fragment=w,v.jsx=S,v.jsxs=S,m.exports=v;var E,T=m.exports,C=t;E=C.createRoot,C.hydrateRoot;var j={};Object.defineProperty(j,"__esModule",{value:!0}),j.parse=function(e,t){const r=new I,n=e.length;if(n<2)return r;const s=(null==t?void 0:t.decode)||L;let i=0;do{const t=e.indexOf("=",i);if(-1===t)break;const o=e.indexOf(";",i),a=-1===o?n:o;if(t>a){i=e.lastIndexOf(";",t-1)+1;continue}const l=N(e,i,t),c=D(e,t,l),u=e.slice(l,c);if(void 0===r[u]){let n=N(e,t+1,a),i=D(e,a,n);const o=s(e.slice(n,i));r[u]=o}i=a+1}while(i<n);return r},j.serialize=function(e,t,r){const n=(null==r?void 0:r.encode)||encodeURIComponent;if(!R.test(e))throw new TypeError(`argument name is invalid: ${e}`);const s=n(t);if(!O.test(s))throw new TypeError(`argument val is invalid: ${t}`);let i=e+"="+s;if(!r)return i;if(void 0!==r.maxAge){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!P.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!A.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!function(e){return"[object Date]"===$.call(e)}
/**
 * react-router v7.4.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}r.httpOnly&&(i+="; HttpOnly");r.secure&&(i+="; Secure");r.partitioned&&(i+="; Partitioned");if(r.priority){switch("string"==typeof r.priority?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}}if(r.sameSite){switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}}return i};const R=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,O=/^[\u0021-\u003A\u003C-\u007E]*$/,P=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,A=/^[\u0020-\u003A\u003D-\u007E]*$/,$=Object.prototype.toString,I=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function N(e,t,r){do{const r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r);return r}function D(e,t,r){for(;t>r;){const r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function L(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}var M="popstate";function U(e={}){return function(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,a="POP",l=null,c=u();null==c&&(c=0,o.replaceState({...o.state,idx:c},""));function u(){return(o.state||{idx:null}).idx}function d(){a="POP";let e=u(),t=null==e?null:e-c;c=e,l&&l({action:a,location:g.location,delta:t})}function h(e,t){a="PUSH";let r=q(g.location,e,t);c=u()+1;let n=z(r,c),d=g.createHref(r);try{o.pushState(n,"",d)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;s.location.assign(d)}i&&l&&l({action:a,location:g.location,delta:1})}function f(e,t){a="REPLACE";let r=q(g.location,e,t);c=u();let n=z(r,c),s=g.createHref(r);o.replaceState(n,"",s),i&&l&&l({action:a,location:g.location,delta:0})}function p(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,r="string"==typeof e?e:J(e);return r=r.replace(/ $/,"%20"),B(t,`No window.location.(origin|href) available to create URL for href: ${r}`),new URL(r,t)}let g={get action(){return a},get location(){return e(s,o)},listen(e){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(M,d),l=e,()=>{s.removeEventListener(M,d),l=null}},createHref:e=>t(s,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:h,replace:f,go:e=>o.go(e)};return g}((function(e,t){let{pathname:r,search:n,hash:s}=e.location;return q("",{pathname:r,search:n,hash:s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"==typeof t?t:J(t)}),0,e)}function B(e,t){if(!1===e||null==e)throw new Error(t)}function F(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function z(e,t){return{usr:e.state,key:e.key,idx:t}}function q(e,t,r=null,n){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?K(t):t,state:r,key:t&&t.key||n||Math.random().toString(36).substring(2,10)}}function J({pathname:e="/",search:t="",hash:r=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}function K(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function W(e,t,r="/"){return function(e,t,r,n){let s="string"==typeof t?K(t):t,i=oe(s.pathname||"/",r);if(null==i)return null;let o=H(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(o);let a=null;for(let l=0;null==a&&l<o.length;++l){let e=ie(i);a=ne(o[l],e,n)}return a}(e,t,r,!1)}function H(e,t=[],r=[],n=""){let s=(e,s,i)=>{let o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};o.relativePath.startsWith("/")&&(B(o.relativePath.startsWith(n),`Absolute route path "${o.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),o.relativePath=o.relativePath.slice(n.length));let a=ue([n,o.relativePath]),l=r.concat(o);e.children&&e.children.length>0&&(B(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${a}".`),H(e.children,t,l,a)),(null!=e.path||e.index)&&t.push({path:a,score:re(a,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var r;if(""!==e.path&&(null==(r=e.path)?void 0:r.includes("?")))for(let n of G(e.path))s(e,t,n);else s(e,t)})),t}function G(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(0===n.length)return s?[i,""]:[i];let o=G(n.join("/")),a=[];return a.push(...o.map((e=>""===e?i:[i,e].join("/")))),s&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}var V=/^:[\w-]+$/,Y=3,X=2,Z=1,Q=10,ee=-2,te=e=>"*"===e;function re(e,t){let r=e.split("/"),n=r.length;return r.some(te)&&(n+=ee),t&&(n+=X),r.filter((e=>!te(e))).reduce(((e,t)=>e+(V.test(t)?Y:""===t?Z:Q)),n)}function ne(e,t,r=!1){let{routesMeta:n}=e,s={},i="/",o=[];for(let a=0;a<n.length;++a){let e=n[a],l=a===n.length-1,c="/"===i?t:t.slice(i.length)||"/",u=se({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&r&&!n[n.length-1].route.index&&(u=se({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(s,u.params),o.push({params:s,pathname:ue([i,u.pathname]),pathnameBase:de(ue([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=ue([i,u.pathnameBase]))}return o}function se(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t=!1,r=!0){F("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),s+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":""!==e&&"/"!==e&&(s+="(?:(?=\\/|$))");let i=new RegExp(s,t?void 0:"i");return[i,n]}(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:n.reduce(((e,{paramName:t,isOptional:r},n)=>{if("*"===t){let e=a[n]||"";o=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const s=a[n];return e[t]=r&&!s?void 0:(s||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:o,pattern:e}}function ie(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return F(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function oe(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function ae(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function le(e){let t=function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(e);return t.map(((e,r)=>r===t.length-1?e.pathname:e.pathnameBase))}function ce(e,t,r,n=!1){let s;"string"==typeof e?s=K(e):(s={...e},B(!s.pathname||!s.pathname.includes("?"),ae("?","pathname","search",s)),B(!s.pathname||!s.pathname.includes("#"),ae("#","pathname","hash",s)),B(!s.search||!s.search.includes("#"),ae("#","search","hash",s)));let i,o=""===e||""===s.pathname,a=o?"/":s.pathname;if(null==a)i=r;else{let e=t.length-1;if(!n&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;s.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:r,search:n="",hash:s=""}="string"==typeof e?K(e):e,i=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:i,search:he(n),hash:fe(s)}}(s,i),c=a&&"/"!==a&&a.endsWith("/"),u=(o||"."===a)&&r.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var ue=e=>e.join("/").replace(/\/\/+/g,"/"),de=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),he=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",fe=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";var pe=["POST","PUT","PATCH","DELETE"];new Set(pe);var ge=["GET",...pe];new Set(ge);var me=e.createContext(null);me.displayName="DataRouter";var ve=e.createContext(null);ve.displayName="DataRouterState";var ye=e.createContext({isTransitioning:!1});ye.displayName="ViewTransition",e.createContext(new Map).displayName="Fetchers",e.createContext(null).displayName="Await";var be=e.createContext(null);be.displayName="Navigation";var we=e.createContext(null);we.displayName="Location";var _e=e.createContext({outlet:null,matches:[],isDataRoute:!1});_e.displayName="Route";var xe=e.createContext(null);function ke(){return null!=e.useContext(we)}function Se(){return B(ke(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(we).location}xe.displayName="RouteError";var Ee="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Te(t){e.useContext(be).static||e.useLayoutEffect(t)}function Ce(){let{isDataRoute:t}=e.useContext(_e);return t?function(){let{router:t}=function(t){let r=e.useContext(me);return B(r,Ie(t)),r}("useNavigate"),r=Ne("useNavigate"),n=e.useRef(!1);return Te((()=>{n.current=!0})),e.useCallback((async(e,s={})=>{F(n.current,Ee),n.current&&("number"==typeof e?t.navigate(e):await t.navigate(e,{fromRouteId:r,...s}))}),[t,r])}():function(){B(ke(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(me),{basename:r,navigator:n}=e.useContext(be),{matches:s}=e.useContext(_e),{pathname:i}=Se(),o=JSON.stringify(le(s)),a=e.useRef(!1);return Te((()=>{a.current=!0})),e.useCallback(((e,s={})=>{if(F(a.current,Ee),!a.current)return;if("number"==typeof e)return void n.go(e);let l=ce(e,JSON.parse(o),i,"path"===s.relative);null==t&&"/"!==r&&(l.pathname="/"===l.pathname?r:ue([r,l.pathname])),(s.replace?n.replace:n.push)(l,s.state,s)}),[r,n,o,i,t])}()}function je(t,{relative:r}={}){let{matches:n}=e.useContext(_e),{pathname:s}=Se(),i=JSON.stringify(le(n));return e.useMemo((()=>ce(t,JSON.parse(i),s,"path"===r)),[t,i,s,r])}function Re(t,r,n,s){var i;B(ke(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o,static:a}=e.useContext(be),{matches:l}=e.useContext(_e),c=l[l.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",f=c&&c.route;{let e=f&&f.path||"";Le(d,!f||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let p,g=Se();if(r){let e="string"==typeof r?K(r):r;B("/"===h||(null==(i=e.pathname)?void 0:i.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${e.pathname}" was given in the \`location\` prop.`),p=e}else p=g;let m=p.pathname||"/",v=m;if("/"!==h){let e=h.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=!a&&n&&n.matches&&n.matches.length>0?n.matches:W(t,{pathname:v});F(f||null!=y,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),F(null==y||void 0!==y[y.length-1].route.element||void 0!==y[y.length-1].route.Component||void 0!==y[y.length-1].route.lazy,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=function(t,r=[],n=null){if(null==t){if(!n)return null;if(n.errors)t=n.matches;else{if(0!==r.length||n.initialized||!(n.matches.length>0))return null;t=n.matches}}let s=t,i=null==n?void 0:n.errors;if(null!=i){let e=s.findIndex((e=>e.route.id&&void 0!==(null==i?void 0:i[e.route.id])));B(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,e+1))}let o=!1,a=-1;if(n)for(let e=0;e<s.length;e++){let t=s[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(a=e),t.route.id){let{loaderData:e,errors:r}=n,i=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!r||void 0===r[t.route.id]);if(t.route.lazy||i){o=!0,s=a>=0?s.slice(0,a+1):[s[0]];break}}}return s.reduceRight(((t,l,c)=>{let u,d=!1,h=null,f=null;n&&(u=i&&l.route.id?i[l.route.id]:void 0,h=l.route.errorElement||Pe,o&&(a<0&&0===c?(Le("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,f=null):a===c&&(d=!0,f=l.route.hydrateFallbackElement||null)));let p=r.concat(s.slice(0,c+1)),g=()=>{let r;return r=u?h:d?f:l.route.Component?e.createElement(l.route.Component,null):l.route.element?l.route.element:t,e.createElement($e,{match:l,routeContext:{outlet:t,matches:p,isDataRoute:null!=n},children:r})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?e.createElement(Ae,{location:n.location,revalidation:n.revalidation,component:h,error:u,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()}),null)}(y&&y.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:ue([h,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:ue([h,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,s);return r&&b?e.createElement(we.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},b):b}function Oe(){let t=function(){var t;let r=e.useContext(xe),n=function(t){let r=e.useContext(ve);return B(r,Ie(t)),r}("useRouteError"),s=Ne("useRouteError");if(void 0!==r)return r;return null==(t=n.errors)?void 0:t[s]}(),r=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=e.createElement(e.Fragment,null,e.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:o},"ErrorBoundary")," or"," ",e.createElement("code",{style:o},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},r),n?e.createElement("pre",{style:i},n):null,a)}e.createContext(null);var Pe=e.createElement(Oe,null),Ae=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?e.createElement(_e.Provider,{value:this.props.routeContext},e.createElement(xe.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function $e({routeContext:t,match:r,children:n}){let s=e.useContext(me);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),e.createElement(_e.Provider,{value:t},n)}function Ie(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ne(t){let r=function(t){let r=e.useContext(_e);return B(r,Ie(t)),r}(t),n=r.matches[r.matches.length-1];return B(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}var De={};function Le(e,t,r){t||De[e]||(De[e]=!0,F(!1,r))}function Me({to:t,replace:r,state:n,relative:s}){B(ke(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=e.useContext(be);F(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=e.useContext(_e),{pathname:a}=Se(),l=Ce(),c=ce(t,le(o),a,"path"===s),u=JSON.stringify(c);return e.useEffect((()=>{l(JSON.parse(u),{replace:r,state:n,relative:s})}),[l,u,s,r,n]),null}function Ue(e){B(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Be({basename:t="/",children:r=null,location:n,navigationType:s="POP",navigator:i,static:o=!1}){B(!ke(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),l=e.useMemo((()=>({basename:a,navigator:i,static:o,future:{}})),[a,i,o]);"string"==typeof n&&(n=K(n));let{pathname:c="/",search:u="",hash:d="",state:h=null,key:f="default"}=n,p=e.useMemo((()=>{let e=oe(c,a);return null==e?null:{location:{pathname:e,search:u,hash:d,state:h,key:f},navigationType:s}}),[a,c,u,d,h,f,s]);return F(null!=p,`<Router basename="${a}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),null==p?null:e.createElement(be.Provider,{value:l},e.createElement(we.Provider,{children:r,value:p}))}function Fe({children:e,location:t}){return Re(ze(e),t)}function ze(t,r=[]){let n=[];return e.Children.forEach(t,((t,s)=>{if(!e.isValidElement(t))return;let i=[...r,s];if(t.type===e.Fragment)return void n.push.apply(n,ze(t.props.children,i));B(t.type===Ue,`[${"string"==typeof t.type?t.type:t.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),B(!t.props.index||!t.props.children,"An index route cannot have child routes.");let o={id:t.props.id||i.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(o.children=ze(t.props.children,i)),n.push(o)})),n}e.memo((function({routes:e,future:t,state:r}){return Re(e,void 0,r,t)}));var qe="get",Je="application/x-www-form-urlencoded";function Ke(e){return null!=e&&"string"==typeof e.tagName}var We=null;var He=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ge(e){return null==e||He.has(e)?e:(F(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Je}"`),null)}function Ve(e,t){let r,n,s,i,o;if(Ke(a=e)&&"form"===a.tagName.toLowerCase()){let o=e.getAttribute("action");n=o?oe(o,t):null,r=e.getAttribute("method")||qe,s=Ge(e.getAttribute("enctype"))||Je,i=new FormData(e)}else if(function(e){return Ke(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Ke(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let o=e.form;if(null==o)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let a=e.getAttribute("formaction")||o.getAttribute("action");if(n=a?oe(a,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||qe,s=Ge(e.getAttribute("formenctype"))||Ge(o.getAttribute("enctype"))||Je,i=new FormData(o,e),!function(){if(null===We)try{new FormData(document.createElement("form"),0),We=!1}catch(e){We=!0}return We}()){let{name:t,type:r,value:n}=e;if("image"===r){let e=t?`${t}.`:"";i.append(`${e}x`,"0"),i.append(`${e}y`,"0")}else t&&i.append(t,n)}}else{if(Ke(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=qe,n=null,s=Je,o=e}var a;return i&&"text/plain"===s&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:i,body:o}}function Ye(e,t){if(!1===e||null==e)throw new Error(t)}function Xe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}async function Ze(e,t,r){return function(e,t){let r=new Set;return new Set(t),e.reduce(((e,t)=>{let n=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}(t));return r.has(n)||(r.add(n),e.push({key:n,link:t})),e}),[])}((await Promise.all(e.map((async e=>{let n=t.routes[e.route.id];if(n){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}(n,r);return e.links?e.links():[]}return[]})))).flat(1).filter(Xe).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}function Qe(e,t,r,n,s,i){let o=(e,t)=>!r[t]||e.route.id!==r[t].route.id,a=(e,t)=>{var n;return r[t].pathname!==e.pathname||(null==(n=r[t].route.path)?void 0:n.endsWith("*"))&&r[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter(((e,t)=>o(e,t)||a(e,t))):"data"===i?t.filter(((t,i)=>{var l;let c=n.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(o(t,i)||a(t,i))return!0;if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:(null==(l=r[0])?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof n)return n}return!0})):[]}function et(e,t,{includeHydrateFallback:r}={}){return n=e.map((e=>{let n=t.routes[e.route.id];if(!n)return[];let s=[n.module];return n.clientActionModule&&(s=s.concat(n.clientActionModule)),n.clientLoaderModule&&(s=s.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(s=s.concat(n.hydrateFallbackModule)),n.imports&&(s=s.concat(n.imports)),s})).flat(1),[...new Set(n)];var n}function tt(){let t=e.useContext(me);return Ye(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}var rt=e.createContext(void 0);function nt(){let t=e.useContext(rt);return Ye(t,"You must render this element inside a <HydratedRouter> element"),t}function st(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function it({page:t,...r}){let{router:n}=tt(),s=e.useMemo((()=>W(n.routes,t,n.basename)),[n.routes,t,n.basename]);return s?e.createElement(ot,{page:t,matches:s,...r}):null}function ot({page:t,matches:r,...n}){let s=Se(),{manifest:i,routeModules:o}=nt(),{basename:a}=tt(),{loaderData:l,matches:c}=function(){let t=e.useContext(ve);return Ye(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}(),u=e.useMemo((()=>Qe(t,r,c,i,s,"data")),[t,r,c,i,s]),d=e.useMemo((()=>Qe(t,r,c,i,s,"assets")),[t,r,c,i,s]),h=e.useMemo((()=>{if(t===s.pathname+s.search+s.hash)return[];let e=new Set,n=!1;if(r.forEach((t=>{var r;let s=i.routes[t.route.id];s&&s.hasLoader&&(!u.some((e=>e.route.id===t.route.id))&&t.route.id in l&&(null==(r=o[t.route.id])?void 0:r.shouldRevalidate)||s.hasClientLoader?n=!0:e.add(t.route.id))})),0===e.size)return[];let c=function(e,t){let r="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.data":t&&"/"===oe(r.pathname,t)?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}(t,a);return n&&e.size>0&&c.searchParams.set("_routes",r.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[c.pathname+c.search]}),[a,l,s,i,u,r,t,o]),f=e.useMemo((()=>et(d,i)),[d,i]),p=function(t){let{manifest:r,routeModules:n}=nt(),[s,i]=e.useState([]);return e.useEffect((()=>{let e=!1;return Ze(t,r,n).then((t=>{e||i(t)})),()=>{e=!0}}),[t,r,n]),s}(d);return e.createElement(e.Fragment,null,h.map((t=>e.createElement("link",{key:t,rel:"prefetch",as:"fetch",href:t,...n}))),f.map((t=>e.createElement("link",{key:t,rel:"modulepreload",href:t,...n}))),p.map((({key:t,link:r})=>e.createElement("link",{key:t,...r}))))}function at(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}rt.displayName="FrameworkContext";var lt="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{lt&&(window.__reactRouterVersion="7.4.1")}catch(Va){}function ct({basename:t,children:r,window:n}){let s=e.useRef();null==s.current&&(s.current=U({window:n,v5Compat:!0}));let i=s.current,[o,a]=e.useState({action:i.action,location:i.location}),l=e.useCallback((t=>{e.startTransition((()=>a(t)))}),[a]);return e.useLayoutEffect((()=>i.listen(l)),[i,l]),e.createElement(Be,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i})}var ut=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dt=e.forwardRef((function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,...h},f){let p,{basename:g}=e.useContext(be),m="string"==typeof c&&ut.test(c),v=!1;if("string"==typeof c&&m&&(p=c,lt))try{let e=new URL(window.location.href),t=c.startsWith("//")?new URL(e.protocol+c):new URL(c),r=oe(t.pathname,g);t.origin===e.origin&&null!=r?c=r+t.search+t.hash:v=!0}catch(Va){F(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=function(t,{relative:r}={}){B(ke(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=e.useContext(be),{hash:i,pathname:o,search:a}=je(t,{relative:r}),l=o;return"/"!==n&&(l="/"===o?n:ue([n,o])),s.createHref({pathname:l,search:a,hash:i})}(c,{relative:s}),[b,w,_]=function(t,r){let n=e.useContext(rt),[s,i]=e.useState(!1),[o,a]=e.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=r,f=e.useRef(null);e.useEffect((()=>{if("render"===t&&a(!0),"viewport"===t){let e=new IntersectionObserver((e=>{e.forEach((e=>{a(e.isIntersecting)}))}),{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}}),[t]),e.useEffect((()=>{if(s){let e=setTimeout((()=>{a(!0)}),100);return()=>{clearTimeout(e)}}}),[s]);let p=()=>{i(!0)},g=()=>{i(!1),a(!1)};return n?"intent"!==t?[o,f,{}]:[o,f,{onFocus:st(l,p),onBlur:st(c,g),onMouseEnter:st(u,p),onMouseLeave:st(d,g),onTouchStart:st(h,p)}]:[!1,f,{}]}(n,h),x=function(t,{target:r,replace:n,state:s,preventScrollReset:i,relative:o,viewTransition:a}={}){let l=Ce(),c=Se(),u=je(t,{relative:o});return e.useCallback((e=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(e,r)){e.preventDefault();let r=void 0!==n?n:J(c)===J(u);l(t,{replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a})}}),[c,l,u,n,s,r,t,i,o,a])}(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:d});let k=e.createElement("a",{...h,..._,href:p||y,onClick:v||i?t:function(e){t&&t(e),e.defaultPrevented||x(e)},ref:at(f,w),target:l,"data-discover":m||"render"!==r?void 0:"true"});return b&&!m?e.createElement(e.Fragment,null,k,e.createElement(it,{page:y})):k}));dt.displayName="Link",e.forwardRef((function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...c},u){let d=je(o,{relative:c.relative}),h=Se(),f=e.useContext(ve),{navigator:p,basename:g}=e.useContext(be),m=null!=f&&function(t,r={}){let n=e.useContext(ye);B(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=ft("useViewTransitionState"),i=je(t,{relative:r.relative});if(!n.isTransitioning)return!1;let o=oe(n.currentLocation.pathname,s)||n.currentLocation.pathname,a=oe(n.nextLocation.pathname,s)||n.nextLocation.pathname;return null!=se(i.pathname,a)||null!=se(i.pathname,o)}(d)&&!0===a,v=p.encodeLocation?p.encodeLocation(d).pathname:d.pathname,y=h.pathname,b=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&g&&(b=oe(b,g)||b);const w="/"!==v&&v.endsWith("/")?v.length-1:v.length;let _,x=y===v||!s&&y.startsWith(v)&&"/"===y.charAt(w),k=null!=b&&(b===v||!s&&b.startsWith(v)&&"/"===b.charAt(v.length)),S={isActive:x,isPending:k,isTransitioning:m},E=x?t:void 0;_="function"==typeof n?n(S):[n,x?"active":null,k?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let T="function"==typeof i?i(S):i;return e.createElement(dt,{...c,"aria-current":E,className:_,ref:u,style:T,to:o,viewTransition:a},"function"==typeof l?l(S):l)})).displayName="NavLink";var ht=e.forwardRef((({discover:t="render",fetcherKey:r,navigate:n,reloadDocument:s,replace:i,state:o,method:a=qe,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:h,...f},p)=>{let g=function(){let{router:t}=ft("useSubmit"),{basename:r}=e.useContext(be),n=Ne("useRouteId");return e.useCallback((async(e,s={})=>{let{action:i,method:o,encType:a,formData:l,body:c}=Ve(e,r);if(!1===s.navigate){let e=s.fetcherKey||gt();await t.fetch(e,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})}),[t,r,n])}(),m=function(t,{relative:r}={}){let{basename:n}=e.useContext(be),s=e.useContext(_e);B(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),o={...je(t||".",{relative:r})},a=Se();if(null==t){o.search=a.search;let e=new URLSearchParams(o.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let r=e.toString();o.search=r?`?${r}`:""}}t&&"."!==t||!i.route.index||(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(o.pathname="/"===o.pathname?n:ue([n,o.pathname]));return J(o)}(l,{relative:u}),v="get"===a.toLowerCase()?"get":"post",y="string"==typeof l&&ut.test(l);return e.createElement("form",{ref:p,method:v,action:m,onSubmit:s?c:e=>{if(c&&c(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,s=(null==t?void 0:t.getAttribute("formmethod"))||a;g(t||e.currentTarget,{fetcherKey:r,method:s,navigate:n,replace:i,state:o,relative:u,preventScrollReset:d,viewTransition:h})},...f,"data-discover":y||"render"!==t?void 0:"true"})}));function ft(t){let r=e.useContext(me);return B(r,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(t)),r}ht.displayName="Form";var pt=0,gt=()=>`__${String(++pt)}__`;new TextEncoder;const mt="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function vt(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function yt(e){return"nodeType"in e}function bt(e){var t,r;return e?vt(e)?e:yt(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function wt(e){const{Document:t}=bt(e);return e instanceof t}function _t(e){return!vt(e)&&e instanceof bt(e).HTMLElement}function xt(e){return e instanceof bt(e).SVGElement}function kt(e){return e?vt(e)?e.document:yt(e)?wt(e)?e:_t(e)||xt(e)?e.ownerDocument:document:document:document}const St=mt?e.useLayoutEffect:e.useEffect;function Et(t){const r=e.useRef(t);return St((()=>{r.current=t})),e.useCallback((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return null==r.current?void 0:r.current(...t)}),[])}function Tt(t,r){void 0===r&&(r=[t]);const n=e.useRef(t);return St((()=>{n.current!==t&&(n.current=t)}),r),n}function Ct(t,r){const n=e.useRef();return e.useMemo((()=>{const e=t(n.current);return n.current=e,e}),[...r])}function jt(t){const r=Et(t),n=e.useRef(null),s=e.useCallback((e=>{e!==n.current&&(null==r||r(e,n.current)),n.current=e}),[]);return[n,s]}function Rt(t){const r=e.useRef();return e.useEffect((()=>{r.current=t}),[t]),r.current}let Ot={};function Pt(t,r){return e.useMemo((()=>{if(r)return r;const e=null==Ot[t]?0:Ot[t]+1;return Ot[t]=e,t+"-"+e}),[t,r])}function At(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce(((t,r)=>{const n=Object.entries(r);for(const[s,i]of n){const r=t[s];null!=r&&(t[s]=r+e*i)}return t}),{...t})}}const $t=At(1),It=At(-1);function Nt(e){if(!e)return!1;const{KeyboardEvent:t}=bt(e.target);return t&&e instanceof t}function Dt(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=bt(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const Lt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Lt.Translate.toString(e),Lt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),Mt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ut(e){return e.matches(Mt)?e:e.querySelector(Mt)}const Bt={display:"none"};function Ft(e){let{id:t,value:n}=e;return r.createElement("div",{id:t,style:Bt},n)}function zt(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;return r.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":s,"aria-atomic":!0},n)}const qt=e.createContext(null);const Jt={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},Kt={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Wt(n){let{announcements:s=Kt,container:i,hiddenTextDescribedById:o,screenReaderInstructions:a=Jt}=n;const{announce:l,announcement:c}=function(){const[t,r]=e.useState("");return{announce:e.useCallback((e=>{null!=e&&r(e)}),[]),announcement:t}}(),u=Pt("DndLiveRegion"),[d,h]=e.useState(!1);if(e.useEffect((()=>{h(!0)}),[]),function(t){const r=e.useContext(qt);e.useEffect((()=>{if(!r)throw new Error("useDndMonitor must be used within a children of <DndContext>");return r(t)}),[t,r])}(e.useMemo((()=>({onDragStart(e){let{active:t}=e;l(s.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;s.onDragMove&&l(s.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;l(s.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;l(s.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;l(s.onDragCancel({active:t,over:r}))}})),[l,s])),!d)return null;const f=r.createElement(r.Fragment,null,r.createElement(Ft,{id:o,value:a.draggable}),r.createElement(zt,{id:u,announcement:c}));return i?t.createPortal(f,i):f}var Ht,Gt;function Vt(){}function Yt(t,r){return e.useMemo((()=>({sensor:t,options:null!=r?r:{}})),[t,r])}(Gt=Ht||(Ht={})).DragStart="dragStart",Gt.DragMove="dragMove",Gt.DragEnd="dragEnd",Gt.DragCancel="dragCancel",Gt.DragOver="dragOver",Gt.RegisterDroppable="registerDroppable",Gt.SetDroppableDisabled="setDroppableDisabled",Gt.UnregisterDroppable="unregisterDroppable";const Xt=Object.freeze({x:0,y:0});function Zt(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Qt(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function er(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function tr(e){let{left:t,top:r,height:n,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+n},{x:t+s,y:r+n}]}function rr(e,t){if(!e||0===e.length)return null;const[r]=e;return r[t]}function nr(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}const sr=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=nr(t,t.left,t.top),i=[];for(const o of n){const{id:e}=o,t=r.get(e);if(t){const r=Zt(nr(t),s);i.push({id:e,data:{droppableContainer:o,value:r}})}}return i.sort(Qt)};function ir(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),o=s-n,a=i-r;if(n<s&&r<i){const r=t.width*t.height,n=e.width*e.height,s=o*a;return Number((s/(r+n-s)).toFixed(4))}return 0}const or=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=[];for(const i of n){const{id:e}=i,n=r.get(e);if(n){const r=ir(n,t);r>0&&s.push({id:e,data:{droppableContainer:i,value:r}})}}return s.sort(er)};function ar(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Xt}function lr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce(((t,r)=>({...t,top:t.top+e*r.y,bottom:t.bottom+e*r.y,left:t.left+e*r.x,right:t.right+e*r.x})),{...t})}}const cr=lr(1);const ur={ignoreTransform:!1};function dr(e,t){void 0===t&&(t=ur);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:n}=bt(e).getComputedStyle(e);t&&(r=function(e,t,r){const n=function(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}(t);if(!n)return e;const{scaleX:s,scaleY:i,x:o,y:a}=n,l=e.left-o-(1-s)*parseFloat(r),c=e.top-a-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),u=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}(r,t,n))}const{top:n,left:s,width:i,height:o,bottom:a,right:l}=r;return{top:n,left:s,width:i,height:o,bottom:a,right:l}}function hr(e){return dr(e,{ignoreTransform:!0})}function fr(e,t){const r=[];return e?function n(s){if(null!=t&&r.length>=t)return r;if(!s)return r;if(wt(s)&&null!=s.scrollingElement&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!_t(s)||xt(s))return r;if(r.includes(s))return r;const i=bt(e).getComputedStyle(s);return s!==e&&function(e,t){void 0===t&&(t=bt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some((e=>{const n=t[e];return"string"==typeof n&&r.test(n)}))}(s,i)&&r.push(s),function(e,t){return void 0===t&&(t=bt(e).getComputedStyle(e)),"fixed"===t.position}(s,i)?r:n(s.parentNode)}(e):r}function pr(e){const[t]=fr(e,1);return null!=t?t:null}function gr(e){return mt&&e?vt(e)?e:yt(e)?wt(e)||e===kt(e).scrollingElement?window:_t(e)?e:null:null:null}function mr(e){return vt(e)?e.scrollX:e.scrollLeft}function vr(e){return vt(e)?e.scrollY:e.scrollTop}function yr(e){return{x:mr(e),y:vr(e)}}var br,wr;function _r(e){return!(!mt||!e)&&e===document.scrollingElement}function xr(e){const t={x:0,y:0},r=_r(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}(wr=br||(br={}))[wr.Forward=1]="Forward",wr[wr.Backward=-1]="Backward";const kr={x:.2,y:.2};function Sr(e,t,r,n,s){let{top:i,left:o,right:a,bottom:l}=r;void 0===n&&(n=10),void 0===s&&(s=kr);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=xr(e),f={x:0,y:0},p={x:0,y:0},g=t.height*s.y,m=t.width*s.x;return!c&&i<=t.top+g?(f.y=br.Backward,p.y=n*Math.abs((t.top+g-i)/g)):!u&&l>=t.bottom-g&&(f.y=br.Forward,p.y=n*Math.abs((t.bottom-g-l)/g)),!h&&a>=t.right-m?(f.x=br.Forward,p.x=n*Math.abs((t.right-m-a)/m)):!d&&o<=t.left+m&&(f.x=br.Backward,p.x=n*Math.abs((t.left+m-o)/m)),{direction:f,speed:p}}function Er(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:r,right:n,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:s,width:e.clientWidth,height:e.clientHeight}}function Tr(e){return e.reduce(((e,t)=>$t(e,yr(t))),Xt)}const Cr=[["x",["left","right"],function(e){return e.reduce(((e,t)=>e+mr(t)),0)}],["y",["top","bottom"],function(e){return e.reduce(((e,t)=>e+vr(t)),0)}]];class jr{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=fr(t),n=Tr(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[s,i,o]of Cr)for(const e of i)Object.defineProperty(this,e,{get:()=>{const t=o(r),i=n[s]-t;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Rr{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach((e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)}))},this.target=e}add(e,t,r){var n;null==(n=this.target)||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function Or(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t&&n>t.y}var Pr,Ar,$r,Ir;function Nr(e){e.preventDefault()}function Dr(e){e.stopPropagation()}(Ar=Pr||(Pr={})).Click="click",Ar.DragStart="dragstart",Ar.Keydown="keydown",Ar.ContextMenu="contextmenu",Ar.Resize="resize",Ar.SelectionChange="selectionchange",Ar.VisibilityChange="visibilitychange",(Ir=$r||($r={})).Space="Space",Ir.Down="ArrowDown",Ir.Right="ArrowRight",Ir.Left="ArrowLeft",Ir.Up="ArrowUp",Ir.Esc="Escape",Ir.Enter="Enter",Ir.Tab="Tab";const Lr={start:[$r.Space,$r.Enter],cancel:[$r.Esc],end:[$r.Space,$r.Enter,$r.Tab]},Mr=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case $r.Right:return{...r,x:r.x+25};case $r.Left:return{...r,x:r.x-25};case $r.Down:return{...r,y:r.y+25};case $r.Up:return{...r,y:r.y-25}}};class Ur{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new Rr(kt(t)),this.windowListeners=new Rr(bt(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Pr.Resize,this.handleCancel),this.windowListeners.add(Pr.VisibilityChange,this.handleCancel),setTimeout((()=>this.listeners.add(Pr.Keydown,this.handleKeyDown)))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&function(e,t){if(void 0===t&&(t=dr),!e)return;const{top:r,left:n,bottom:s,right:i}=t(e);pr(e)&&(s<=0||i<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}(r),t(Xt)}handleKeyDown(e){if(Nt(e)){const{active:t,context:r,options:n}=this.props,{keyboardCodes:s=Lr,coordinateGetter:i=Mr,scrollBehavior:o="smooth"}=n,{code:a}=e;if(s.end.includes(a))return void this.handleEnd(e);if(s.cancel.includes(a))return void this.handleCancel(e);const{collisionRect:l}=r.current,c=l?{x:l.left,y:l.top}:Xt;this.referenceCoordinates||(this.referenceCoordinates=c);const u=i(e,{active:t,context:r.current,currentCoordinates:c});if(u){const t=It(u,c),n={x:0,y:0},{scrollableAncestors:s}=r.current;for(const r of s){const s=e.code,{isTop:i,isRight:a,isLeft:l,isBottom:c,maxScroll:d,minScroll:h}=xr(r),f=Er(r),p={x:Math.min(s===$r.Right?f.right-f.width/2:f.right,Math.max(s===$r.Right?f.left:f.left+f.width/2,u.x)),y:Math.min(s===$r.Down?f.bottom-f.height/2:f.bottom,Math.max(s===$r.Down?f.top:f.top+f.height/2,u.y))},g=s===$r.Right&&!a||s===$r.Left&&!l,m=s===$r.Down&&!c||s===$r.Up&&!i;if(g&&p.x!==u.x){const e=r.scrollLeft+t.x,i=s===$r.Right&&e<=d.x||s===$r.Left&&e>=h.x;if(i&&!t.y)return void r.scrollTo({left:e,behavior:o});n.x=i?r.scrollLeft-e:s===$r.Right?r.scrollLeft-d.x:r.scrollLeft-h.x,n.x&&r.scrollBy({left:-n.x,behavior:o});break}if(m&&p.y!==u.y){const e=r.scrollTop+t.y,i=s===$r.Down&&e<=d.y||s===$r.Up&&e>=h.y;if(i&&!t.x)return void r.scrollTo({top:e,behavior:o});n.y=i?r.scrollTop-e:s===$r.Down?r.scrollTop-d.y:r.scrollTop-h.y,n.y&&r.scrollBy({top:-n.y,behavior:o});break}}this.handleMove(e,$t(It(u,this.referenceCoordinates),n))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function Br(e){return Boolean(e&&"distance"in e)}function Fr(e){return Boolean(e&&"delay"in e)}Ur.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=Lr,onActivation:s}=t,{active:i}=r;const{code:o}=e.nativeEvent;if(n.start.includes(o)){const t=i.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==s||s({event:e.nativeEvent}),!0)}return!1}}];class zr{constructor(e,t,r){var n;void 0===r&&(r=function(e){const{EventTarget:t}=bt(e);return e instanceof t?e:kt(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:s}=e,{target:i}=s;this.props=e,this.events=t,this.document=kt(i),this.documentListeners=new Rr(this.document),this.listeners=new Rr(r),this.windowListeners=new Rr(bt(i)),this.initialCoordinates=null!=(n=Dt(s))?n:Xt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Pr.Resize,this.handleCancel),this.windowListeners.add(Pr.DragStart,Nr),this.windowListeners.add(Pr.VisibilityChange,this.handleCancel),this.windowListeners.add(Pr.ContextMenu,Nr),this.documentListeners.add(Pr.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Fr(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(Br(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:r,onPending:n}=this.props;n(r,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Pr.Click,Dr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Pr.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:n,props:s}=this,{onMove:i,options:{activationConstraint:o}}=s;if(!n)return;const a=null!=(t=Dt(e))?t:Xt,l=It(n,a);if(!r&&o){if(Br(o)){if(null!=o.tolerance&&Or(l,o.tolerance))return this.handleCancel();if(Or(l,o.distance))return this.handleStart()}return Fr(o)&&Or(l,o.tolerance)?this.handleCancel():void this.handlePending(o,l)}e.cancelable&&e.preventDefault(),i(a)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===$r.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const qr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Jr extends zr{constructor(e){const{event:t}=e,r=kt(t.target);super(e,qr,r)}}Jr.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!(!r.isPrimary||0!==r.button)&&(null==n||n({event:r}),!0)}}];const Kr={move:{name:"mousemove"},end:{name:"mouseup"}};var Wr,Hr;(Hr=Wr||(Wr={}))[Hr.RightClick=2]="RightClick";(class extends zr{constructor(e){super(e,Kr,kt(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button!==Wr.RightClick&&(null==n||n({event:r}),!0)}}];const Gr={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var Vr,Yr,Xr,Zr;function Qr(t){let{acceleration:r,activator:n=Vr.Pointer,canScroll:s,draggingRect:i,enabled:o,interval:a=5,order:l=Xr.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:f}=t;const p=function(e){let{delta:t,disabled:r}=e;const n=Rt(t);return Ct((e=>{if(r||!n||!e)return en;const s={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[br.Backward]:e.x[br.Backward]||-1===s.x,[br.Forward]:e.x[br.Forward]||1===s.x},y:{[br.Backward]:e.y[br.Backward]||-1===s.y,[br.Forward]:e.y[br.Forward]||1===s.y}}}),[r,t,n])}({delta:h,disabled:!o}),[g,m]=function(){const t=e.useRef(null);return[e.useCallback(((e,r)=>{t.current=setInterval(e,r)}),[]),e.useCallback((()=>{null!==t.current&&(clearInterval(t.current),t.current=null)}),[])]}(),v=e.useRef({x:0,y:0}),y=e.useRef({x:0,y:0}),b=e.useMemo((()=>{switch(n){case Vr.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Vr.DraggableRect:return i}}),[n,i,c]),w=e.useRef(null),_=e.useCallback((()=>{const e=w.current;if(!e)return;const t=v.current.x*y.current.x,r=v.current.y*y.current.y;e.scrollBy(t,r)}),[]),x=e.useMemo((()=>l===Xr.TreeOrder?[...u].reverse():u),[l,u]);e.useEffect((()=>{if(o&&u.length&&b){for(const e of x){if(!1===(null==s?void 0:s(e)))continue;const t=u.indexOf(e),n=d[t];if(!n)continue;const{direction:i,speed:o}=Sr(e,n,b,r,f);for(const e of["x","y"])p[e][i[e]]||(o[e]=0,i[e]=0);if(o.x>0||o.y>0)return m(),w.current=e,g(_,a),v.current=o,void(y.current=i)}v.current={x:0,y:0},y.current={x:0,y:0},m()}else m()}),[r,_,s,m,o,a,JSON.stringify(b),JSON.stringify(p),g,u,x,d,JSON.stringify(f)])}(class extends zr{constructor(e){super(e,Gr)}static setup(){return window.addEventListener(Gr.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Gr.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:s}=r;return!(s.length>1)&&(null==n||n({event:r}),!0)}}],(Yr=Vr||(Vr={}))[Yr.Pointer=0]="Pointer",Yr[Yr.DraggableRect=1]="DraggableRect",(Zr=Xr||(Xr={}))[Zr.TreeOrder=0]="TreeOrder",Zr[Zr.ReversedTreeOrder=1]="ReversedTreeOrder";const en={x:{[br.Backward]:!1,[br.Forward]:!1},y:{[br.Backward]:!1,[br.Forward]:!1}};var tn,rn,nn;(rn=tn||(tn={}))[rn.Always=0]="Always",rn[rn.BeforeDragging=1]="BeforeDragging",rn[rn.WhileDragging=2]="WhileDragging",(nn||(nn={})).Optimized="optimized";const sn=new Map;function on(e,t){return Ct((r=>e?r||("function"==typeof t?t(e):e):null),[t,e])}function an(t){let{callback:r,disabled:n}=t;const s=Et(r),i=e.useMemo((()=>{if(n||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(s)}),[n]);return e.useEffect((()=>()=>null==i?void 0:i.disconnect()),[i]),i}function ln(e){return new jr(dr(e),e)}function cn(t,r,n){void 0===r&&(r=ln);const[s,i]=e.useState(null);function o(){i((e=>{if(!t)return null;var s;if(!1===t.isConnected)return null!=(s=null!=e?e:n)?s:null;const i=r(t);return JSON.stringify(e)===JSON.stringify(i)?e:i}))}const a=function(t){let{callback:r,disabled:n}=t;const s=Et(r),i=e.useMemo((()=>{if(n||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:e}=window;return new e(s)}),[s,n]);return e.useEffect((()=>()=>null==i?void 0:i.disconnect()),[i]),i}({callback(e){if(t)for(const r of e){const{type:e,target:n}=r;if("childList"===e&&n instanceof HTMLElement&&n.contains(t)){o();break}}}}),l=an({callback:o});return St((()=>{o(),t?(null==l||l.observe(t),null==a||a.observe(document.body,{childList:!0,subtree:!0})):(null==l||l.disconnect(),null==a||a.disconnect())}),[t]),s}const un=[];function dn(t,r){void 0===r&&(r=[]);const n=e.useRef(null);return e.useEffect((()=>{n.current=null}),r),e.useEffect((()=>{const e=t!==Xt;e&&!n.current&&(n.current=t),!e&&n.current&&(n.current=null)}),[t]),n.current?It(t,n.current):Xt}function hn(t){return e.useMemo((()=>t?function(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}(t):null),[t])}const fn=[];function pn(t){let{measure:r}=t;const[n,s]=e.useState(null),i=an({callback:e.useCallback((e=>{for(const{target:t}of e)if(_t(t)){s((e=>{const n=r(t);return e?{...e,width:n.width,height:n.height}:n}));break}}),[r])}),o=e.useCallback((e=>{const t=function(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return _t(t)?t:e}(e);null==i||i.disconnect(),t&&(null==i||i.observe(t)),s(t?r(t):null)}),[r,i]),[a,l]=jt(o);return e.useMemo((()=>({nodeRef:a,rect:n,setRef:l})),[n,a,l])}const gn=[{sensor:Jr,options:{}},{sensor:Ur,options:{}}],mn={current:{}},vn={draggable:{measure:hr},droppable:{measure:hr,strategy:tn.WhileDragging,frequency:nn.Optimized},dragOverlay:{measure:dr}};class yn extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter((e=>{let{disabled:t}=e;return!t}))}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}const bn={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new yn,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Vt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:vn,measureDroppableContainers:Vt,windowRect:null,measuringScheduled:!1},wn={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Vt,draggableNodes:new Map,over:null,measureDroppableContainers:Vt},_n=e.createContext(wn),xn=e.createContext(bn);function kn(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new yn}}}function Sn(e,t){switch(t.type){case Ht.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ht.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ht.DragEnd:case Ht.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ht.RegisterDroppable:{const{element:r}=t,{id:n}=r,s=new yn(e.droppable.containers);return s.set(n,r),{...e,droppable:{...e.droppable,containers:s}}}case Ht.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const o=new yn(e.droppable.containers);return o.set(r,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:o}}}case Ht.UnregisterDroppable:{const{id:r,key:n}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const i=new yn(e.droppable.containers);return i.delete(r),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function En(t){let{disabled:r}=t;const{active:n,activatorEvent:s,draggableNodes:i}=e.useContext(_n),o=Rt(s),a=Rt(null==n?void 0:n.id);return e.useEffect((()=>{if(!r&&!s&&o&&null!=a){if(!Nt(o))return;if(document.activeElement===o.target)return;const e=i.get(a);if(!e)return;const{activatorNode:t,node:r}=e;if(!t.current&&!r.current)return;requestAnimationFrame((()=>{for(const e of[t.current,r.current]){if(!e)continue;const t=Ut(e);if(t){t.focus();break}}}))}}),[s,r,i,a,o]),null}const Tn=e.createContext({...Xt,scaleX:1,scaleY:1});var Cn,jn;(jn=Cn||(Cn={}))[jn.Uninitialized=0]="Uninitialized",jn[jn.Initializing=1]="Initializing",jn[jn.Initialized=2]="Initialized";const Rn=e.memo((function(n){var s,i,o,a;let{id:l,accessibility:c,autoScroll:u=!0,children:d,sensors:h=gn,collisionDetection:f=or,measuring:p,modifiers:g,...m}=n;const v=e.useReducer(Sn,void 0,kn),[y,b]=v,[w,_]=function(){const[t]=e.useState((()=>new Set)),r=e.useCallback((e=>(t.add(e),()=>t.delete(e))),[t]);return[e.useCallback((e=>{let{type:r,event:n}=e;t.forEach((e=>{var t;return null==(t=e[r])?void 0:t.call(e,n)}))}),[t]),r]}(),[x,k]=e.useState(Cn.Uninitialized),S=x===Cn.Initialized,{draggable:{active:E,nodes:T,translate:C},droppable:{containers:j}}=y,R=null!=E?T.get(E):null,O=e.useRef({initial:null,translated:null}),P=e.useMemo((()=>{var e;return null!=E?{id:E,data:null!=(e=null==R?void 0:R.data)?e:mn,rect:O}:null}),[E,R]),A=e.useRef(null),[$,I]=e.useState(null),[N,D]=e.useState(null),L=Tt(m,Object.values(m)),M=Pt("DndDescribedBy",l),U=e.useMemo((()=>j.getEnabled()),[j]),B=(F=p,e.useMemo((()=>({draggable:{...vn.draggable,...null==F?void 0:F.draggable},droppable:{...vn.droppable,...null==F?void 0:F.droppable},dragOverlay:{...vn.dragOverlay,...null==F?void 0:F.dragOverlay}})),[null==F?void 0:F.draggable,null==F?void 0:F.droppable,null==F?void 0:F.dragOverlay]));var F;const{droppableRects:z,measureDroppableContainers:q,measuringScheduled:J}=function(t,r){let{dragging:n,dependencies:s,config:i}=r;const[o,a]=e.useState(null),{frequency:l,measure:c,strategy:u}=i,d=e.useRef(t),h=function(){switch(u){case tn.Always:return!1;case tn.BeforeDragging:return n;default:return!n}}(),f=Tt(h),p=e.useCallback((function(e){void 0===e&&(e=[]),f.current||a((t=>null===t?e:t.concat(e.filter((e=>!t.includes(e))))))}),[f]),g=e.useRef(null),m=Ct((e=>{if(h&&!n)return sn;if(!e||e===sn||d.current!==t||null!=o){const e=new Map;for(let r of t){if(!r)continue;if(o&&o.length>0&&!o.includes(r.id)&&r.rect.current){e.set(r.id,r.rect.current);continue}const t=r.node.current,n=t?new jr(c(t),t):null;r.rect.current=n,n&&e.set(r.id,n)}return e}return e}),[t,o,n,h,c]);return e.useEffect((()=>{d.current=t}),[t]),e.useEffect((()=>{h||p()}),[n,h]),e.useEffect((()=>{o&&o.length>0&&a(null)}),[JSON.stringify(o)]),e.useEffect((()=>{h||"number"!=typeof l||null!==g.current||(g.current=setTimeout((()=>{p(),g.current=null}),l))}),[l,h,p,...s]),{droppableRects:m,measureDroppableContainers:p,measuringScheduled:null!=o}}(U,{dragging:S,dependencies:[C.x,C.y],config:B.droppable}),K=function(e,t){const r=null!=t?e.get(t):void 0,n=r?r.node.current:null;return Ct((e=>{var r;return null==t?null:null!=(r=null!=n?n:e)?r:null}),[n,t])}(T,E),W=e.useMemo((()=>N?Dt(N):null),[N]),H=function(){const e=!1===(null==$?void 0:$.autoScrollEnabled),t="object"==typeof u?!1===u.enabled:!1===u,r=S&&!e&&!t;if("object"==typeof u)return{...u,enabled:r};return{enabled:r}}(),G=function(e,t){return on(e,t)}(K,B.draggable.measure);!function(t){let{activeNode:r,measure:n,initialRect:s,config:i=!0}=t;const o=e.useRef(!1),{x:a,y:l}="boolean"==typeof i?{x:i,y:i}:i;St((()=>{if(!a&&!l||!r)return void(o.current=!1);if(o.current||!s)return;const e=null==r?void 0:r.node.current;if(!e||!1===e.isConnected)return;const t=ar(n(e),s);if(a||(t.x=0),l||(t.y=0),o.current=!0,Math.abs(t.x)>0||Math.abs(t.y)>0){const r=pr(e);r&&r.scrollBy({top:t.y,left:t.x})}}),[r,a,l,s,n])}({activeNode:null!=E?T.get(E):null,config:H.layoutShiftCompensation,initialRect:G,measure:B.draggable.measure});const V=cn(K,B.draggable.measure,G),Y=cn(K?K.parentElement:null),X=e.useRef({activatorEvent:null,active:null,activeNode:K,collisionRect:null,collisions:null,droppableRects:z,draggableNodes:T,draggingNode:null,draggingNodeRect:null,droppableContainers:j,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Z=j.getNodeFor(null==(s=X.current.over)?void 0:s.id),Q=pn({measure:B.dragOverlay.measure}),ee=null!=(i=Q.nodeRef.current)?i:K,te=S?null!=(o=Q.rect)?o:V:null,re=Boolean(Q.nodeRef.current&&Q.rect),ne=ar(se=re?null:V,on(se));var se;const ie=hn(ee?bt(ee):null),oe=function(t){const r=e.useRef(t),n=Ct((e=>t?e&&e!==un&&t&&r.current&&t.parentNode===r.current.parentNode?e:fr(t):un),[t]);return e.useEffect((()=>{r.current=t}),[t]),n}(S?null!=Z?Z:K:null),ae=function(t,r){void 0===r&&(r=dr);const[n]=t,s=hn(n?bt(n):null),[i,o]=e.useState(fn);function a(){o((()=>t.length?t.map((e=>_r(e)?s:new jr(r(e),e))):fn))}const l=an({callback:a});return St((()=>{null==l||l.disconnect(),a(),t.forEach((e=>null==l?void 0:l.observe(e)))}),[t]),i}(oe),le=function(e,t){let{transform:r,...n}=t;return null!=e&&e.length?e.reduce(((e,t)=>t({transform:e,...n})),r):r}(g,{transform:{x:C.x-ne.x,y:C.y-ne.y,scaleX:1,scaleY:1},activatorEvent:N,active:P,activeNodeRect:V,containerNodeRect:Y,draggingNodeRect:te,over:X.current.over,overlayNodeRect:Q.rect,scrollableAncestors:oe,scrollableAncestorRects:ae,windowRect:ie}),ce=W?$t(W,C):null,ue=function(t){const[r,n]=e.useState(null),s=e.useRef(t),i=e.useCallback((e=>{const t=gr(e.target);t&&n((e=>e?(e.set(t,yr(t)),new Map(e)):null))}),[]);return e.useEffect((()=>{const e=s.current;if(t!==e){r(e);const o=t.map((e=>{const t=gr(e);return t?(t.addEventListener("scroll",i,{passive:!0}),[t,yr(t)]):null})).filter((e=>null!=e));n(o.length?new Map(o):null),s.current=t}return()=>{r(t),r(e)};function r(e){e.forEach((e=>{const t=gr(e);null==t||t.removeEventListener("scroll",i)}))}}),[i,t]),e.useMemo((()=>t.length?r?Array.from(r.values()).reduce(((e,t)=>$t(e,t)),Xt):Tr(t):Xt),[t,r])}(oe),de=dn(ue),he=dn(ue,[V]),fe=$t(le,de),pe=te?cr(te,le):null,ge=P&&pe?f({active:P,collisionRect:pe,droppableRects:z,droppableContainers:U,pointerCoordinates:ce}):null,me=rr(ge,"id"),[ve,ye]=e.useState(null),be=function(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}(re?le:$t(le,he),null!=(a=null==ve?void 0:ve.rect)?a:null,V),we=e.useRef(null),_e=e.useCallback(((e,r)=>{let{sensor:n,options:s}=r;if(null==A.current)return;const i=T.get(A.current);if(!i)return;const o=e.nativeEvent,a=new n({active:A.current,activeNode:i,event:o,options:s,context:X,onAbort(e){if(!T.get(e))return;const{onDragAbort:t}=L.current,r={id:e};null==t||t(r),w({type:"onDragAbort",event:r})},onPending(e,t,r,n){if(!T.get(e))return;const{onDragPending:s}=L.current,i={id:e,constraint:t,initialCoordinates:r,offset:n};null==s||s(i),w({type:"onDragPending",event:i})},onStart(e){const r=A.current;if(null==r)return;const n=T.get(r);if(!n)return;const{onDragStart:s}=L.current,i={activatorEvent:o,active:{id:r,data:n.data,rect:O}};t.unstable_batchedUpdates((()=>{null==s||s(i),k(Cn.Initializing),b({type:Ht.DragStart,initialCoordinates:e,active:r}),w({type:"onDragStart",event:i}),I(we.current),D(o)}))},onMove(e){b({type:Ht.DragMove,coordinates:e})},onEnd:l(Ht.DragEnd),onCancel:l(Ht.DragCancel)});function l(e){return async function(){const{active:r,collisions:n,over:s,scrollAdjustedTranslate:i}=X.current;let a=null;if(r&&i){const{cancelDrop:t}=L.current;if(a={activatorEvent:o,active:r,collisions:n,delta:i,over:s},e===Ht.DragEnd&&"function"==typeof t){await Promise.resolve(t(a))&&(e=Ht.DragCancel)}}A.current=null,t.unstable_batchedUpdates((()=>{b({type:e}),k(Cn.Uninitialized),ye(null),I(null),D(null),we.current=null;const t=e===Ht.DragEnd?"onDragEnd":"onDragCancel";if(a){const e=L.current[t];null==e||e(a),w({type:t,event:a})}}))}}we.current=a}),[T]),xe=function(t,r){return e.useMemo((()=>t.reduce(((e,t)=>{const{sensor:n}=t;return[...e,...n.activators.map((e=>({eventName:e.eventName,handler:r(e.handler,t)})))]}),[])),[t,r])}(h,e.useCallback(((e,t)=>(r,n)=>{const s=r.nativeEvent,i=T.get(n);if(null!==A.current||!i||s.dndKit||s.defaultPrevented)return;const o={active:i};!0===e(r,t.options,o)&&(s.dndKit={capturedBy:t.sensor},A.current=n,_e(r,t))}),[T,_e]));!function(t){e.useEffect((()=>{if(!mt)return;const e=t.map((e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()}));return()=>{for(const t of e)null==t||t()}}),t.map((e=>{let{sensor:t}=e;return t})))}(h),St((()=>{V&&x===Cn.Initializing&&k(Cn.Initialized)}),[V,x]),e.useEffect((()=>{const{onDragMove:e}=L.current,{active:r,activatorEvent:n,collisions:s,over:i}=X.current;if(!r||!n)return;const o={active:r,activatorEvent:n,collisions:s,delta:{x:fe.x,y:fe.y},over:i};t.unstable_batchedUpdates((()=>{null==e||e(o),w({type:"onDragMove",event:o})}))}),[fe.x,fe.y]),e.useEffect((()=>{const{active:e,activatorEvent:r,collisions:n,droppableContainers:s,scrollAdjustedTranslate:i}=X.current;if(!e||null==A.current||!r||!i)return;const{onDragOver:o}=L.current,a=s.get(me),l=a&&a.rect.current?{id:a.id,rect:a.rect.current,data:a.data,disabled:a.disabled}:null,c={active:e,activatorEvent:r,collisions:n,delta:{x:i.x,y:i.y},over:l};t.unstable_batchedUpdates((()=>{ye(l),null==o||o(c),w({type:"onDragOver",event:c})}))}),[me]),St((()=>{X.current={activatorEvent:N,active:P,activeNode:K,collisionRect:pe,collisions:ge,droppableRects:z,draggableNodes:T,draggingNode:ee,draggingNodeRect:te,droppableContainers:j,over:ve,scrollableAncestors:oe,scrollAdjustedTranslate:fe},O.current={initial:te,translated:pe}}),[P,K,ge,pe,T,ee,te,z,j,ve,oe,fe]),Qr({...H,delta:C,draggingRect:pe,pointerCoordinates:ce,scrollableAncestors:oe,scrollableAncestorRects:ae});const ke=e.useMemo((()=>({active:P,activeNode:K,activeNodeRect:V,activatorEvent:N,collisions:ge,containerNodeRect:Y,dragOverlay:Q,draggableNodes:T,droppableContainers:j,droppableRects:z,over:ve,measureDroppableContainers:q,scrollableAncestors:oe,scrollableAncestorRects:ae,measuringConfiguration:B,measuringScheduled:J,windowRect:ie})),[P,K,V,N,ge,Y,Q,T,j,z,ve,q,oe,ae,B,J,ie]),Se=e.useMemo((()=>({activatorEvent:N,activators:xe,active:P,activeNodeRect:V,ariaDescribedById:{draggable:M},dispatch:b,draggableNodes:T,over:ve,measureDroppableContainers:q})),[N,xe,P,V,b,M,T,ve,q]);return r.createElement(qt.Provider,{value:_},r.createElement(_n.Provider,{value:Se},r.createElement(xn.Provider,{value:ke},r.createElement(Tn.Provider,{value:be},d)),r.createElement(En,{disabled:!1===(null==c?void 0:c.restoreFocus)})),r.createElement(Wt,{...c,hiddenTextDescribedById:M}))})),On=e.createContext(null),Pn="button";function An(t){let{id:r,data:n,disabled:s=!1,attributes:i}=t;const o=Pt("Draggable"),{activators:a,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:f}=e.useContext(_n),{role:p=Pn,roleDescription:g="draggable",tabIndex:m=0}=null!=i?i:{},v=(null==c?void 0:c.id)===r,y=e.useContext(v?Tn:On),[b,w]=jt(),[_,x]=jt(),k=function(t,r){return e.useMemo((()=>t.reduce(((e,t)=>{let{eventName:n,handler:s}=t;return e[n]=e=>{s(e,r)},e}),{})),[t,r])}(a,r),S=Tt(n);St((()=>(h.set(r,{id:r,key:o,node:b,activatorNode:_,data:S}),()=>{const e=h.get(r);e&&e.key===o&&h.delete(r)})),[h,r]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:e.useMemo((()=>({role:p,tabIndex:m,"aria-disabled":s,"aria-pressed":!(!v||p!==Pn)||void 0,"aria-roledescription":g,"aria-describedby":d.draggable})),[s,p,m,v,g,d.draggable]),isDragging:v,listeners:s?void 0:k,node:b,over:f,setNodeRef:w,setActivatorNodeRef:x,transform:y}}const $n={timeout:25};function In(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function Nn(e,t){return e.reduce(((e,r,n)=>{const s=t.get(r);return s&&(e[n]=s),e}),Array(e.length))}function Dn(e){return null!==e&&e>=0}const Ln=e=>{let{rects:t,activeIndex:r,overIndex:n,index:s}=e;const i=In(t,n,r),o=t[s],a=i[s];return a&&o?{x:a.left-o.left,y:a.top-o.top,scaleX:a.width/o.width,scaleY:a.height/o.height}:null},Mn={scaleX:1,scaleY:1},Un=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:s,rects:i,overIndex:o}=e;const a=null!=(t=i[r])?t:n;if(!a)return null;if(s===r){const e=i[o];return e?{x:0,y:r<o?e.top+e.height-(a.top+a.height):e.top-a.top,...Mn}:null}const l=function(e,t,r){const n=e[t],s=e[t-1],i=e[t+1];if(!n)return 0;if(r<t)return s?n.top-(s.top+s.height):i?i.top-(n.top+n.height):0;return i?i.top-(n.top+n.height):s?n.top-(s.top+s.height):0}(i,s,r);return s>r&&s<=o?{x:0,y:-a.height-l,...Mn}:s<r&&s>=o?{x:0,y:a.height+l,...Mn}:{x:0,y:0,...Mn}};const Bn="Sortable",Fn=r.createContext({activeIndex:-1,containerId:Bn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ln,disabled:{draggable:!1,droppable:!1}});function zn(t){let{children:n,id:s,items:i,strategy:o=Ln,disabled:a=!1}=t;const{active:l,dragOverlay:c,droppableRects:u,over:d,measureDroppableContainers:h}=e.useContext(xn),f=Pt(Bn,s),p=Boolean(null!==c.rect),g=e.useMemo((()=>i.map((e=>"object"==typeof e&&"id"in e?e.id:e))),[i]),m=null!=l,v=l?g.indexOf(l.id):-1,y=d?g.indexOf(d.id):-1,b=e.useRef(g),w=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(g,b.current),_=-1!==y&&-1===v||w,x=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(a);St((()=>{w&&m&&h(g)}),[w,g,m,h]),e.useEffect((()=>{b.current=g}),[g]);const k=e.useMemo((()=>({activeIndex:v,containerId:f,disabled:x,disableTransforms:_,items:g,overIndex:y,useDragOverlay:p,sortedRects:Nn(g,u),strategy:o})),[v,f,x.draggable,x.droppable,_,g,y,u,p,o]);return r.createElement(Fn.Provider,{value:k},n)}const qn=e=>{let{id:t,items:r,activeIndex:n,overIndex:s}=e;return In(r,n,s).indexOf(t)},Jn=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:s,items:i,newIndex:o,previousItems:a,previousContainerId:l,transition:c}=e;return!(!c||!n)&&((a===i||s!==o)&&(!!r||o!==s&&t===l))},Kn={duration:200,easing:"ease"},Wn="transform",Hn=Lt.Transition.toString({property:Wn,duration:0,easing:"linear"}),Gn={roleDescription:"sortable"};function Vn(t){let{animateLayoutChanges:r=Jn,attributes:n,disabled:s,data:i,getNewIndex:o=qn,id:a,strategy:l,resizeObserverConfig:c,transition:u=Kn}=t;const{items:d,containerId:h,activeIndex:f,disabled:p,disableTransforms:g,sortedRects:m,overIndex:v,useDragOverlay:y,strategy:b}=e.useContext(Fn),w=function(e,t){var r,n;if("boolean"==typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(r=null==e?void 0:e.draggable)?r:t.draggable,droppable:null!=(n=null==e?void 0:e.droppable)?n:t.droppable}}(s,p),_=d.indexOf(a),x=e.useMemo((()=>({sortable:{containerId:h,index:_,items:d},...i})),[h,i,_,d]),k=e.useMemo((()=>d.slice(d.indexOf(a))),[d,a]),{rect:S,node:E,isOver:T,setNodeRef:C}=function(t){let{data:r,disabled:n=!1,id:s,resizeObserverConfig:i}=t;const o=Pt("Droppable"),{active:a,dispatch:l,over:c,measureDroppableContainers:u}=e.useContext(_n),d=e.useRef({disabled:n}),h=e.useRef(!1),f=e.useRef(null),p=e.useRef(null),{disabled:g,updateMeasurementsFor:m,timeout:v}={...$n,...i},y=Tt(null!=m?m:s),b=an({callback:e.useCallback((()=>{h.current?(null!=p.current&&clearTimeout(p.current),p.current=setTimeout((()=>{u(Array.isArray(y.current)?y.current:[y.current]),p.current=null}),v)):h.current=!0}),[v]),disabled:g||!a}),w=e.useCallback(((e,t)=>{b&&(t&&(b.unobserve(t),h.current=!1),e&&b.observe(e))}),[b]),[_,x]=jt(w),k=Tt(r);return e.useEffect((()=>{b&&_.current&&(b.disconnect(),h.current=!1,b.observe(_.current))}),[_,b]),e.useEffect((()=>(l({type:Ht.RegisterDroppable,element:{id:s,key:o,disabled:n,node:_,rect:f,data:k}}),()=>l({type:Ht.UnregisterDroppable,key:o,id:s}))),[s]),e.useEffect((()=>{n!==d.current.disabled&&(l({type:Ht.SetDroppableDisabled,id:s,key:o,disabled:n}),d.current.disabled=n)}),[s,o,n,l]),{active:a,rect:f,isOver:(null==c?void 0:c.id)===s,node:_,over:c,setNodeRef:x}}({id:a,data:x,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:j,activatorEvent:R,activeNodeRect:O,attributes:P,setNodeRef:A,listeners:$,isDragging:I,over:N,setActivatorNodeRef:D,transform:L}=An({id:a,data:x,attributes:{...Gn,...n},disabled:w.draggable}),M=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.useMemo((()=>e=>{r.forEach((t=>t(e)))}),r)}(C,A),U=Boolean(j),B=U&&!g&&Dn(f)&&Dn(v),F=!y&&I,z=F&&B?L:null,q=B?null!=z?z:(null!=l?l:b)({rects:m,activeNodeRect:O,activeIndex:f,overIndex:v,index:_}):null,J=Dn(f)&&Dn(v)?o({id:a,items:d,activeIndex:f,overIndex:v}):_,K=null==j?void 0:j.id,W=e.useRef({activeId:K,items:d,newIndex:J,containerId:h}),H=d!==W.current.items,G=r({active:j,containerId:h,isDragging:I,isSorting:U,id:a,index:_,items:d,newIndex:W.current.newIndex,previousItems:W.current.items,previousContainerId:W.current.containerId,transition:u,wasDragging:null!=W.current.activeId}),V=function(t){let{disabled:r,index:n,node:s,rect:i}=t;const[o,a]=e.useState(null),l=e.useRef(n);return St((()=>{if(!r&&n!==l.current&&s.current){const e=i.current;if(e){const t=dr(s.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&a(r)}}n!==l.current&&(l.current=n)}),[r,n,s,i]),e.useEffect((()=>{o&&a(null)}),[o]),o}({disabled:!G,index:_,node:E,rect:S});return e.useEffect((()=>{U&&W.current.newIndex!==J&&(W.current.newIndex=J),h!==W.current.containerId&&(W.current.containerId=h),d!==W.current.items&&(W.current.items=d)}),[U,J,h,d]),e.useEffect((()=>{if(K===W.current.activeId)return;if(null!=K&&null==W.current.activeId)return void(W.current.activeId=K);const e=setTimeout((()=>{W.current.activeId=K}),50);return()=>clearTimeout(e)}),[K]),{active:j,activeIndex:f,attributes:P,data:x,rect:S,index:_,newIndex:J,items:d,isOver:T,isSorting:U,isDragging:I,listeners:$,node:E,overIndex:v,over:N,setNodeRef:M,setActivatorNodeRef:D,setDroppableNodeRef:C,setDraggableNodeRef:A,transform:null!=V?V:q,transition:function(){if(V||H&&W.current.newIndex===_)return Hn;if(F&&!Nt(R)||!u)return;if(U||G)return Lt.Transition.toString({...u,property:Wn});return}()}}function Yn(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Xn=[$r.Down,$r.Right,$r.Up,$r.Left],Zn=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:i,over:o,scrollableAncestors:a}}=t;if(Xn.includes(e.code)){if(e.preventDefault(),!r||!n)return;const t=[];i.getEnabled().forEach((r=>{if(!r||null!=r&&r.disabled)return;const i=s.get(r.id);if(i)switch(e.code){case $r.Down:n.top<i.top&&t.push(r);break;case $r.Up:n.top>i.top&&t.push(r);break;case $r.Left:n.left>i.left&&t.push(r);break;case $r.Right:n.left<i.left&&t.push(r)}}));const l=(e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=tr(t),i=[];for(const o of n){const{id:e}=o,t=r.get(e);if(t){const r=tr(t),n=s.reduce(((e,t,n)=>e+Zt(r[n],t)),0),a=Number((n/4).toFixed(4));i.push({id:e,data:{droppableContainer:o,value:a}})}}return i.sort(Qt)})({active:r,collisionRect:n,droppableRects:s,droppableContainers:t,pointerCoordinates:null});let c=rr(l,"id");if(c===(null==o?void 0:o.id)&&l.length>1&&(c=l[1].id),null!=c){const e=i.get(r.id),t=i.get(c),o=t?s.get(t.id):null,l=null==t?void 0:t.node.current;if(l&&o&&e&&t){const r=fr(l).some(((e,t)=>a[t]!==e)),s=Qn(e,t),i=function(e,t){if(!Yn(e)||!Yn(t))return!1;if(!Qn(e,t))return!1;return e.data.current.sortable.index<t.data.current.sortable.index}(e,t),c=r||!s?{x:0,y:0}:{x:i?n.width-o.width:0,y:i?n.height-o.height:0},u={x:o.left,y:o.top};return c.x&&c.y?u:It(u,c)}}}};function Qn(e,t){return!(!Yn(e)||!Yn(t))&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}function es({field:e,index:t,updateField:r,removeField:n,error:s}){const{attributes:i,listeners:l,setNodeRef:c,transform:u,transition:d}=Vn({id:t}),h={transform:Lt.Transform.toString(u),transition:d};return T.jsxs("div",{ref:c,style:h,className:"flex gap-4 items-start bg-white p-2 rounded-lg",children:[T.jsx("div",{className:"cursor-move text-gray-400 hover:text-gray-600",...i,...l,children:T.jsx(o,{size:20})}),T.jsxs("div",{className:"flex-1",children:[T.jsx("input",{type:"text",value:e.name,onChange:e=>r(t,{name:e.target.value}),placeholder:"ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500"}),T.jsx("input",{type:"text",value:e.description||"",onChange:e=>r(t,{description:e.target.value}),placeholder:"ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èª¬æ˜Žï¼ˆAIã¸ã®æŒ‡ç¤ºï¼‰",className:"w-full mt-2 px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 text-sm"})]}),T.jsx("div",{className:"w-40",children:T.jsxs("select",{value:e.type,onChange:e=>r(t,{type:e.target.value}),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500",children:[T.jsx("option",{value:"string",children:"æ–‡å­—åˆ—"}),T.jsx("option",{value:"number",children:"æ•°å€¤"}),T.jsx("option",{value:"date",children:"æ—¥ä»˜"})]})}),T.jsx("button",{onClick:()=>n(t),className:"p-2 text-red-500 hover:text-red-700",children:T.jsx(a,{size:20})})]})}function ts({structure:t,setStructure:r}){const[n,s]=e.useState([]),o=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.useMemo((()=>[...r].filter((e=>null!=e))),[...r])}(Yt(Jr),Yt(Ur,{coordinateGetter:Zn})),a=e=>{r(t.filter(((t,r)=>r!==e))),s(n.filter((t=>t.index!==e)))},l=(e,n)=>{if(r(t.map(((t,r)=>r===e?{...t,...n}:t))),"name"in n){const r=((e,r)=>e.trim()?/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)?-1!==t.findIndex(((t,n)=>n!==r&&t.name===e))?"ã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™":null:"ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¯è‹±æ•°å­—ã¨ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã®ã¿ä½¿ç”¨ã§ãã¾ã™ã€‚æœ€åˆã®æ–‡å­—ã¯è‹±å­—ã¾ãŸã¯ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚":"ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¯å¿…é ˆã§ã™")(n.name||"",e);s((t=>{const n=t.filter((t=>t.index!==e));return r&&n.push({index:e,message:r}),n}))}};return T.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[T.jsxs("div",{className:"flex justify-between items-center mb-4",children:[T.jsx("h2",{className:"text-xl font-semibold",children:"ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å®šç¾©"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:()=>{const e=JSON.stringify(t,null,2),r=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(r),s=document.createElement("a");s.href=n,s.download="structure.json",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ"}),T.jsxs("label",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 cursor-pointer",children:["ã‚¤ãƒ³ãƒãƒ¼ãƒˆ",T.jsx("input",{type:"file",accept:".json",onChange:e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];if(!n)return;const i=new FileReader;i.onload=e=>{var t;try{const n=JSON.parse(null==(t=e.target)?void 0:t.result);Array.isArray(n)&&n.every((e=>"string"==typeof e.name&&["string","date","number"].includes(e.type)))?(r(n),s([])):alert("ç„¡åŠ¹ãªæ§‹é€ ãƒ‡ãƒ¼ã‚¿ã§ã™")}catch(n){alert("JSONãƒ•ã‚¡ã‚¤ãƒ«ã®è§£æžã«å¤±æ•—ã—ã¾ã—ãŸ")}},i.readAsText(n)},className:"hidden"})]})]})]}),T.jsx("div",{className:"space-y-4",children:T.jsx(Rn,{sensors:o,collisionDetection:sr,onDragEnd:e=>{const{active:n,over:s}=e;if(s&&n.id!==s.id){const e=n.id,i=s.id;r(In(t,e,i))}},children:T.jsx(zn,{items:t.map(((e,t)=>t)),strategy:Un,children:t.map(((e,t)=>{var r;return T.jsx(es,{field:e,index:t,updateField:l,removeField:a,error:null==(r=n.find((e=>e.index===t)))?void 0:r.message},t)}))})})}),T.jsxs("button",{onClick:()=>{r([...t,{name:"",type:"string",description:""}]),s([])},className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[T.jsx(i,{size:20,className:"mr-2"}),"ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ "]})]})}function rs({structure:t}){const[r,n]=e.useState(""),[s,i]=e.useState(null),[o,a]=e.useState(!1),[h,f]=e.useState(!1),[p,g]=e.useState(null);return T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[T.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[T.jsx("h2",{className:"text-xl font-semibold mb-4",children:"å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆ"}),T.jsx("textarea",{value:r,onChange:e=>n(e.target.value),placeholder:"åˆ†æžã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...",className:"w-full h-64 p-4 border rounded-md focus:ring-2 focus:ring-indigo-500"}),T.jsx("button",{onClick:async()=>{g("APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚APIè¨­å®šã‚¿ãƒ–ã§è¨­å®šã—ã¦ãã ã•ã„ã€‚")},disabled:o||!r.trim(),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-gray-400",children:o?"åˆ†æžä¸­...":T.jsxs(T.Fragment,{children:[T.jsx(l,{size:20,className:"mr-2"}),"åˆ†æžå®Ÿè¡Œ"]})})]}),T.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[T.jsxs("div",{className:"flex justify-between items-center mb-4",children:[T.jsx("h2",{className:"text-xl font-semibold",children:"åˆ†æžçµæžœ"}),s&&T.jsx("button",{onClick:async()=>{if(s)try{const e=[...t.map((e=>s.fields[e.name])),s.memo.replace(/\n/g," ")].join("\t");await navigator.clipboard.writeText(e),f(!0),setTimeout((()=>f(!1)),2e3)}catch(e){g("ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ")}},className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:h?T.jsxs(T.Fragment,{children:[T.jsx(c,{size:16,className:"mr-2 text-green-500"}),"ã‚³ãƒ”ãƒ¼å®Œäº†"]}):T.jsxs(T.Fragment,{children:[T.jsx(u,{size:16,className:"mr-2"}),"å€¤ã‚’ã‚³ãƒ”ãƒ¼"]})})]}),p&&T.jsxs("div",{className:"flex items-center text-red-500 text-sm mb-4",children:[T.jsx(d,{size:16,className:"mr-1"}),p]}),s?T.jsxs("div",{className:"space-y-4",children:[t.map((e=>T.jsxs("div",{className:"border-b pb-2",children:[T.jsx("div",{className:"text-sm text-gray-500",children:e.name}),T.jsx("input",{type:"number"===e.type?"number":"text",value:s.fields[e.name],onChange:t=>{return r=e.name,n=t.target.value,void(s&&i({...s,fields:{...s.fields,[r]:n}}));var r,n},className:"w-full mt-1 px-2 py-1 border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 rounded-md"})]},e.name))),T.jsxs("div",{children:[T.jsx("div",{className:"text-sm text-gray-500",children:"å…ƒã®ãƒ†ã‚­ã‚¹ãƒˆ"}),T.jsx("div",{className:"mt-1 text-gray-700",children:s.memo})]})]}):T.jsx("div",{className:"text-gray-500 text-center py-8",children:"åˆ†æžçµæžœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™"})]})]})}function ns(){return T.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[T.jsx("h2",{className:"text-xl font-semibold mb-4",children:"APIè¨­å®š"}),T.jsx("div",{className:"text-red-600",children:"APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ç®¡ç†è€…ã«é€£çµ¡ã—ã¦ãã ã•ã„ã€‚"})]})}const ss={},is=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));n=Promise.allSettled(t.map((e=>{if((e=function(e){return"/request-text/"+e}(e))in ss)return;ss[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,r&&s.setAttribute("nonce",r),document.head.appendChild(s),t?new Promise(((t,r)=>{s.addEventListener("load",t),s.addEventListener("error",(()=>r(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then((t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)}))};class os extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class as extends os{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ls extends os{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class cs extends os{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var us,ds;(ds=us||(us={})).Any="any",ds.ApNortheast1="ap-northeast-1",ds.ApNortheast2="ap-northeast-2",ds.ApSouth1="ap-south-1",ds.ApSoutheast1="ap-southeast-1",ds.ApSoutheast2="ap-southeast-2",ds.CaCentral1="ca-central-1",ds.EuCentral1="eu-central-1",ds.EuWest1="eu-west-1",ds.EuWest2="eu-west-2",ds.EuWest3="eu-west-3",ds.SaEast1="sa-east-1",ds.UsEast1="us-east-1",ds.UsWest1="us-west-1",ds.UsWest2="us-west-2";var hs=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(Va){i(Va)}}function a(e){try{l(n.throw(e))}catch(Va){i(Va)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class fs{constructor(e,{headers:t={},customFetch:r,region:n=us.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>is((async()=>{const{default:e}=await Promise.resolve().then((()=>Ts));return{default:e}}),[]).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return hs(this,void 0,void 0,(function*(){try{const{headers:n,method:s,body:i}=t;let o,a={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(a["x-region"]=l),i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",o=i):"string"==typeof i?(a["Content-Type"]="text/plain",o=i):"undefined"!=typeof FormData&&i instanceof FormData?o=i:(a["Content-Type"]="application/json",o=JSON.stringify(i)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:o}).catch((e=>{throw new as(e)})),u=c.headers.get("x-relay-error");if(u&&"true"===u)throw new ls(c);if(!c.ok)throw new cs(c);let d,h=(null!==(r=c.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return d="application/json"===h?yield c.json():"application/octet-stream"===h?yield c.blob():"text/event-stream"===h?c:"multipart/form-data"===h?yield c.formData():yield c.text(),{data:d,error:null}}catch(n){return{data:null,error:n}}}))}}var ps={},gs={},ms={},vs={},ys={},bs={},ws=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const _s=ws.fetch,xs=ws.fetch.bind(ws),ks=ws.Headers,Ss=ws.Request,Es=ws.Response,Ts=Object.freeze(Object.defineProperty({__proto__:null,Headers:ks,Request:Ss,Response:Es,default:xs,fetch:_s},Symbol.toStringTag,{value:"Module"})),Cs=n(Ts);var js={};Object.defineProperty(js,"__esModule",{value:!0});let Rs=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};js.default=Rs;var Os=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bs,"__esModule",{value:!0});const Ps=Os(Cs),As=Os(js);bs.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=Ps.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,r,n;let s=null,i=null,o=null,a=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&c&&c.length>1&&(o=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(s={code:"PGRST116",details:`Results contain ${i.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,o=null,a=406,l="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{s=JSON.parse(t),Array.isArray(s)&&404===e.status&&(i=[],s=null,a=200,l="OK")}catch(c){404===e.status&&""===t?(a=204,l="No Content"):s={message:t}}if(s&&this.isMaybeSingle&&(null===(n=null==s?void 0:s.details)||void 0===n?void 0:n.includes("0 rows"))&&(s=null,a=200,l="OK"),s&&this.shouldThrowOnError)throw new As.default(s)}return{error:s,data:i,count:o,status:a,statusText:l}}));return this.shouldThrowOnError||(r=r.catch((e=>{var t,r,n;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(n=null==e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}}))),r.then(e,t)}returns(){return this}overrideTypes(){return this}};var $s=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ys,"__esModule",{value:!0});const Is=$s(bs);let Ns=class extends Is.default{select(e){let t=!1;const r=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const s=void 0===n?"offset":`${n}.offset`,i=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:i="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.Accept)&&void 0!==o?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ys.default=Ns;var Ds=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vs,"__esModule",{value:!0});const Ls=Ds(ys);let Ms=class extends Ls.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let s="";"plain"===n?s="pl":"phrase"===n?s="ph":"websearch"===n&&(s="w");const i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};vs.default=Ms;var Us=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ms,"__esModule",{value:!0});const Bs=Us(vs);ms.default=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=t,this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){const n=t?"HEAD":"GET";let s=!1;const i=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e))).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),new Bs.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new Bs.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){const i=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new Bs.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new Bs.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Bs.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var Fs={},zs={};Object.defineProperty(zs,"__esModule",{value:!0}),zs.version=void 0,zs.version="0.0.0-automated",Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.DEFAULT_HEADERS=void 0;const qs=zs;Fs.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${qs.version}`};var Js=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gs,"__esModule",{value:!0});const Ks=Js(ms),Ws=Js(vs),Hs=Fs;gs.default=class e{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},Hs.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new Ks.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${e}`);let a;r||n?(i=r?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{o.searchParams.append(e,t)}))):(i="POST",a=t);const l=Object.assign({},this.headers);return s&&(l.Prefer=`count=${s}`),new Ws.default({method:i,url:o,headers:l,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};var Gs=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ps,"__esModule",{value:!0}),ps.PostgrestError=ps.PostgrestBuilder=ps.PostgrestTransformBuilder=ps.PostgrestFilterBuilder=ps.PostgrestQueryBuilder=ps.PostgrestClient=void 0;const Vs=Gs(gs);ps.PostgrestClient=Vs.default;const Ys=Gs(ms);ps.PostgrestQueryBuilder=Ys.default;const Xs=Gs(vs);ps.PostgrestFilterBuilder=Xs.default;const Zs=Gs(ys);ps.PostgrestTransformBuilder=Zs.default;const Qs=Gs(bs);ps.PostgrestBuilder=Qs.default;const ei=Gs(js);ps.PostgrestError=ei.default;var ti=ps.default={PostgrestClient:Vs.default,PostgrestQueryBuilder:Ys.default,PostgrestFilterBuilder:Xs.default,PostgrestTransformBuilder:Zs.default,PostgrestBuilder:Qs.default,PostgrestError:ei.default};const{PostgrestClient:ri,PostgrestQueryBuilder:ni,PostgrestFilterBuilder:si,PostgrestTransformBuilder:ii,PostgrestBuilder:oi,PostgrestError:ai}=ti,li={"X-Client-Info":"realtime-js/2.11.2"};var ci,ui,di,hi,fi,pi,gi,mi,vi,yi,bi;(ui=ci||(ci={}))[ui.connecting=0]="connecting",ui[ui.open=1]="open",ui[ui.closing=2]="closing",ui[ui.closed=3]="closed",(hi=di||(di={})).closed="closed",hi.errored="errored",hi.joined="joined",hi.joining="joining",hi.leaving="leaving",(pi=fi||(fi={})).close="phx_close",pi.error="phx_error",pi.join="phx_join",pi.reply="phx_reply",pi.leave="phx_leave",pi.access_token="access_token",(gi||(gi={})).websocket="websocket",(vi=mi||(mi={})).Connecting="connecting",vi.Open="open",vi.Closing="closing",vi.Closed="closed";class wi{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),s=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=r.decode(e.slice(i,i+n));i+=n;const a=r.decode(e.slice(i,i+s));i+=s;return{ref:null,topic:o,event:a,payload:JSON.parse(r.decode(e.slice(i,e.byteLength)))}}}class _i{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}(bi=yi||(yi={})).abstime="abstime",bi.bool="bool",bi.date="date",bi.daterange="daterange",bi.float4="float4",bi.float8="float8",bi.int2="int2",bi.int4="int4",bi.int4range="int4range",bi.int8="int8",bi.int8range="int8range",bi.json="json",bi.jsonb="jsonb",bi.money="money",bi.numeric="numeric",bi.oid="oid",bi.reltime="reltime",bi.text="text",bi.time="time",bi.timestamp="timestamp",bi.timestamptz="timestamptz",bi.timetz="timetz",bi.tsrange="tsrange",bi.tstzrange="tstzrange";const xi=(e,t,r={})=>{var n;const s=null!==(n=r.skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce(((r,n)=>(r[n]=ki(n,e,t,s),r)),{})},ki=(e,t,r,n)=>{const s=t.find((t=>t.name===e)),i=null==s?void 0:s.type,o=r[e];return i&&!n.includes(i)?Si(i,o):Ei(o)},Si=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return Ri(t,r)}switch(e){case yi.bool:return Ti(t);case yi.float4:case yi.float8:case yi.int2:case yi.int4:case yi.int8:case yi.numeric:case yi.oid:return Ci(t);case yi.json:case yi.jsonb:return ji(t);case yi.timestamp:return Oi(t);case yi.abstime:case yi.date:case yi.daterange:case yi.int4range:case yi.int8range:case yi.money:case yi.reltime:case yi.text:case yi.time:case yi.timestamptz:case yi.timetz:case yi.tsrange:case yi.tstzrange:default:return Ei(t)}},Ei=e=>e,Ti=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ci=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},ji=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Ri=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;const i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(s){n=i?i.split(","):[]}return n.map((e=>Si(t,e)))}return e},Oi=e=>"string"==typeof e?e.replace(" ","T"):e,Pi=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Ai{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var $i,Ii,Ni,Di,Li,Mi,Ui,Bi;(Ii=$i||($i={})).SYNC="sync",Ii.JOIN="join",Ii.LEAVE="leave";class Fi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},(e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Fi.syncState(this.state,e,t,r),this.pendingDiffs.forEach((e=>{this.state=Fi.syncDiff(this.state,e,t,r)})),this.pendingDiffs=[],n()})),this.channel._on(r.diff,{},(e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Fi.syncDiff(this.state,e,t,r),n())})),this.onJoin(((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})})),this.onLeave(((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,r,n){const s=this.cloneDeep(e),i=this.transformState(t),o={},a={};return this.map(s,((e,t)=>{i[e]||(a[e]=t)})),this.map(i,((e,t)=>{const r=s[e];if(r){const n=t.map((e=>e.presence_ref)),s=r.map((e=>e.presence_ref)),i=t.filter((e=>s.indexOf(e.presence_ref)<0)),l=r.filter((e=>n.indexOf(e.presence_ref)<0));i.length>0&&(o[e]=i),l.length>0&&(a[e]=l)}else o[e]=t})),this.syncDiff(s,{joins:o,leaves:a},r,n)}static syncDiff(e,t,r,n){const{joins:s,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(s,((t,n)=>{var s;const i=null!==(s=e[t])&&void 0!==s?s:[];if(e[t]=this.cloneDeep(n),i.length>0){const r=e[t].map((e=>e.presence_ref)),n=i.filter((e=>r.indexOf(e.presence_ref)<0));e[t].unshift(...n)}r(t,i,n)})),this.map(i,((t,r)=>{let s=e[t];if(!s)return;const i=r.map((e=>e.presence_ref));s=s.filter((e=>i.indexOf(e.presence_ref)<0)),e[t]=s,n(t,s,r),0===s.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((r=>t(r,e[r])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,r)=>{const n=e[r];return t[r]="metas"in n?n.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):n,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Di=Ni||(Ni={})).ALL="*",Di.INSERT="INSERT",Di.UPDATE="UPDATE",Di.DELETE="DELETE",(Mi=Li||(Li={})).BROADCAST="broadcast",Mi.PRESENCE="presence",Mi.POSTGRES_CHANGES="postgres_changes",Mi.SYSTEM="system",(Bi=Ui||(Ui={})).SUBSCRIBED="SUBSCRIBED",Bi.TIMED_OUT="TIMED_OUT",Bi.CLOSED="CLOSED",Bi.CHANNEL_ERROR="CHANNEL_ERROR";class zi{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=di.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ai(this,fi.join,this.params,this.timeout),this.rejoinTimer=new _i((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=di.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=di.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=di.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=di.errored,this.rejoinTimer.scheduleTimeout())})),this._on(fi.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new Fi(this),this.broadcastEndpointURL=Pi(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError((t=>null==e?void 0:e(Ui.CHANNEL_ERROR,t))),this._onClose((()=>null==e?void 0:e(Ui.CLOSED)));const a={},l={broadcast:s,presence:i,postgres_changes:null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map((e=>e.filter)))&&void 0!==n?n:[],private:o};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0!==t){const n=this.bindings.postgres_changes,s=null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0,i=[];for(let r=0;r<s;r++){const s=n[r],{filter:{event:o,schema:a,table:l,filter:c}}=s,u=t&&t[r];if(!u||u.event!==o||u.schema!==a||u.table!==l||u.filter!==c)return this.unsubscribe(),void(null==e||e(Ui.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},s),{id:u.id}))}return this.bindings.postgres_changes=i,void(e&&e(Ui.SUBSCRIBED))}null==e||e(Ui.SUBSCRIBED)})).receive("error",(t=>{null==e||e(Ui.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null==e||e(Ui.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise((r=>{var n,s,i;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(s=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===s?void 0:s.broadcast)||void 0===i?void 0:i.ack)||r("ok"),o.receive("ok",(()=>r("ok"))),o.receive("error",(()=>r("error"))),o.receive("timeout",(()=>r("timed out")))}));{const{event:i,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(s){return"AbortError"===s.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=di.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fi.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((r=>{const n=new Ai(this,fi.leave,{},e);n.receive("ok",(()=>{t(),r("ok")})).receive("timeout",(()=>{t(),r("timed out")})).receive("error",(()=>{r("error")})),n.send(),this._canPush()||n.trigger("ok",{})}))}async _fetchWithTimeout(e,t,r){const n=new AbortController,s=setTimeout((()=>n.abort()),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(s),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Ai(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,s;const i=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=fi;if(r&&[o,a,l,c].indexOf(i)>=0&&r!==this._joinRef())return;let u=this._onMessage(i,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter((e=>{var t,r,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===i})).map((e=>e.callback(u,r))):null===(s=this.bindings[i])||void 0===s||s.filter((e=>{var r,n,s,o,a,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,o=null===(r=e.filter)||void 0===r?void 0:r.event;return i&&(null===(n=t.ids)||void 0===n?void 0:n.includes(i))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(s=t.data)||void 0===s?void 0:s.type.toLocaleLowerCase()))}{const r=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i})).map((e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:n,type:s,errors:i}=e,o={schema:t,table:r,commit_timestamp:n,eventType:s,new:{},old:{},errors:i};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,r)}))}_isClosed(){return this.state===di.closed}_isJoined(){return this.state===di.joined}_isJoining(){return this.state===di.joining}_isLeaving(){return this.state===di.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),s={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter((e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&zi.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(fi.close,{},e)}_onError(e){this._on(fi.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=di.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=xi(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=xi(e.columns,e.old_record)),t}}const qi=()=>{},Ji="undefined"!=typeof WebSocket;class Ki{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=li,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=qi,this.conn=null,this.sendBuffer=[],this.serializer=new wi,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>is((async()=>{const{default:e}=await Promise.resolve().then((()=>Ts));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${gi.websocket}`,this.httpEndpoint=Pi(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new _i((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(Ji)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new Wi(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),is((async()=>{const{default:e}=await import("./browser--JSpWAzP.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([0,1])).then((({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ci.connecting:return mi.Connecting;case ci.open:return mi.Open;case ci.closing:return mi.Closing;default:return mi.Closed}}isConnected(){return this.connectionState()===mi.Open}channel(e,t={config:{}}){const r=new zi(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:n,ref:s}=e,i=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${r} (${s})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(r){}if(e&&e.exp){if(!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`)}this.accessTokenValue=t,this.channels.forEach((e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(fi.access_token,{access_token:t})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:r,payload:n,ref:s}=e;s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${r} ${s&&"("+s+")"||""}`,n),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(r,n,s))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(fi.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class Wi{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ci.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Hi extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Gi(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class Vi extends Hi{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Yi extends Hi{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Xi=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(Va){i(Va)}}function a(e){try{l(n.throw(e))}catch(Va){i(Va)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const Zi=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>is((async()=>{const{default:e}=await Promise.resolve().then((()=>Ts));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},Qi=e=>{if(Array.isArray(e))return e.map((e=>Qi(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,r])=>{const n=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[n]=Qi(r)})),t};var eo=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(Va){i(Va)}}function a(e){try{l(n.throw(e))}catch(Va){i(Va)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const to=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ro=(e,t,r)=>eo(void 0,void 0,void 0,(function*(){const n=yield Xi(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield is((()=>Promise.resolve().then((()=>Ts))),void 0)).Response:Response}));e instanceof n&&!(null==r?void 0:r.noResolveJson)?e.json().then((r=>{t(new Vi(to(r),e.status||500))})).catch((e=>{t(new Yi(to(e),e))})):t(new Yi(to(e),e))}));function no(e,t,r,n,s,i){return eo(this,void 0,void 0,(function*(){return new Promise(((o,a)=>{e(r,((e,t,r,n)=>{const s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))})(t,n,s,i)).then((e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()})).then((e=>o(e))).catch((e=>ro(e,a,n)))}))}))}function so(e,t,r,n){return eo(this,void 0,void 0,(function*(){return no(e,"GET",t,r,n)}))}function io(e,t,r,n,s){return eo(this,void 0,void 0,(function*(){return no(e,"POST",t,n,s,r)}))}function oo(e,t,r,n,s){return eo(this,void 0,void 0,(function*(){return no(e,"DELETE",t,n,s,r)}))}var ao=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(Va){i(Va)}}function a(e){try{l(n.throw(e))}catch(Va){i(Va)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const lo={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},co={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class uo{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Zi(n)}uploadOrUpdate(e,t,r,n){return ao(this,void 0,void 0,(function*(){try{let s;const i=Object.assign(Object.assign({},co),n);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const a=i.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),a&&s.append("metadata",this.encodeMetadata(a)),s.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(s=r,s.append("cacheControl",i.cacheControl),a&&s.append("metadata",this.encodeMetadata(a))):(s=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==n?void 0:n.headers)&&(o=Object.assign(Object.assign({},o),n.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:o},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{})),d=yield u.json();if(u.ok)return{data:{path:l,id:d.Id,fullPath:d.Key},error:null};return{data:null,error:d}}catch(s){if(Gi(s))return{data:null,error:s};throw s}}))}upload(e,t,r){return ao(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,r)}))}uploadToSignedUrl(e,t,r,n){return ao(this,void 0,void 0,(function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:co.upsert},n),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);const a=yield this.fetch(o.toString(),{method:"PUT",body:e,headers:i}),l=yield a.json();if(a.ok)return{data:{path:s,fullPath:l.Key},error:null};return{data:null,error:l}}catch(a){if(Gi(a))return{data:null,error:a};throw a}}))}createSignedUploadUrl(e,t){return ao(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");const s=yield io(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new Hi("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(r){if(Gi(r))return{data:null,error:r};throw r}}))}update(e,t,r){return ao(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,r)}))}move(e,t,r){return ao(this,void 0,void 0,(function*(){try{return{data:yield io(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}}))}copy(e,t,r){return ao(this,void 0,void 0,(function*(){try{return{data:{path:(yield io(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}}))}createSignedUrl(e,t,r){return ao(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e),s=yield io(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}}))}createSignedUrls(e,t,r){return ao(this,void 0,void 0,(function*(){try{const n=yield io(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${s}`):null}))),error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}}))}download(e,t){return ao(this,void 0,void 0,(function*(){const r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),s=n?`?${n}`:"";try{const t=this._getFinalPath(e),n=yield so(this.fetch,`${this.url}/${r}/${t}${s}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(i){if(Gi(i))return{data:null,error:i};throw i}}))}info(e){return ao(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield so(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Qi(e),error:null}}catch(r){if(Gi(r))return{data:null,error:r};throw r}}))}exists(e){return ao(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,n){return eo(this,void 0,void 0,(function*(){return no(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Gi(r)&&r instanceof Yi){const e=r.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:r}}throw r}}))}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],s=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==s&&n.push(s);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&n.push(o);let a=n.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${a}`)}}}remove(e){return ao(this,void 0,void 0,(function*(){try{return{data:yield oo(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Gi(t))return{data:null,error:t};throw t}}))}list(e,t,r){return ao(this,void 0,void 0,(function*(){try{const n=Object.assign(Object.assign(Object.assign({},lo),t),{prefix:e||""});return{data:yield io(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Gi(n))return{data:null,error:n};throw n}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ho={"X-Client-Info":"storage-js/2.7.1"};var fo=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(Va){i(Va)}}function a(e){try{l(n.throw(e))}catch(Va){i(Va)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class po{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},ho),t),this.fetch=Zi(r)}listBuckets(){return fo(this,void 0,void 0,(function*(){try{return{data:yield so(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Gi(e))return{data:null,error:e};throw e}}))}getBucket(e){return fo(this,void 0,void 0,(function*(){try{return{data:yield so(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Gi(t))return{data:null,error:t};throw t}}))}createBucket(e,t={public:!1}){return fo(this,void 0,void 0,(function*(){try{return{data:yield io(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Gi(r))return{data:null,error:r};throw r}}))}updateBucket(e,t){return fo(this,void 0,void 0,(function*(){try{const r=yield function(e,t,r,n,s){return eo(this,void 0,void 0,(function*(){return no(e,"PUT",t,n,s,r)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:r,error:null}}catch(r){if(Gi(r))return{data:null,error:r};throw r}}))}emptyBucket(e){return fo(this,void 0,void 0,(function*(){try{return{data:yield io(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Gi(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return fo(this,void 0,void 0,(function*(){try{return{data:yield oo(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Gi(t))return{data:null,error:t};throw t}}))}}class go extends po{constructor(e,t={},r){super(e,t,r)}from(e){return new uo(this.url,this.headers,e,this.fetch)}}let mo="";mo="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const vo={headers:{"X-Client-Info":`supabase-js-${mo}/2.49.3`}},yo={schema:"public"},bo={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wo={};var _o=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(Va){i(Va)}}function a(e){try{l(n.throw(e))}catch(Va){i(Va)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const xo=(e,t,r)=>{const n=(e=>{let t;return t=e||("undefined"==typeof fetch?xs:fetch),(...e)=>t(...e)})(r),s="undefined"==typeof Headers?ks:Headers;return(r,i)=>_o(void 0,void 0,void 0,(function*(){var o;const a=null!==(o=yield t())&&void 0!==o?o:e;let l=new s(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),n(r,Object.assign(Object.assign({},i),{headers:l}))}))};var ko=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(Va){i(Va)}}function a(e){try{l(n.throw(e))}catch(Va){i(Va)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const So="2.69.1",Eo=3e4,To=9e4,Co={"X-Client-Info":`gotrue-js/${So}`},jo="X-Supabase-Api-Version",Ro={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Oo=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Po extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Ao(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class $o extends Po{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class Io extends Po{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class No extends Po{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class Do extends No{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Lo extends No{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mo extends No{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Uo extends No{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bo extends No{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Fo extends No{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function zo(e){return Ao(e)&&"AuthRetryableFetchError"===e.name}class qo extends No{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Jo extends No{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ko="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Wo=" \t\n\r=".split(""),Ho=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Wo.length;t+=1)e[Wo[t].charCodeAt(0)]=-2;for(let t=0;t<Ko.length;t+=1)e[Ko[t].charCodeAt(0)]=t;return e})();function Go(e,t,r){const n=Ho[e];if(!(n>-1)){if(-2===n)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Vo(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let o=0;o<e.length;o+=1)Go(e.charCodeAt(o),s,i);return t.join("")}function Yo(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Xo(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let s=0;s<e.length;s+=1)Go(e.charCodeAt(s),r,n);return new Uint8Array(t)}function Zo(e){const t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}Yo(n,t)}}(e,(e=>t.push(e))),new Uint8Array(t)}const Qo=()=>"undefined"!=typeof window&&"undefined"!=typeof document,ea={tested:!1,writable:!1},ta=()=>{if(!Qo())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(Va){return!1}if(ea.tested)return ea.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ea.tested=!0,ea.writable=!0}catch(Va){ea.tested=!0,ea.writable=!1}return ea.writable};const ra=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>is((async()=>{const{default:e}=await Promise.resolve().then((()=>Ts));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},na=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},sa=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(n){return r}},ia=async(e,t)=>{await e.removeItem(t)};class oa{constructor(){this.promise=new oa.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function aa(e){const t=e.split(".");if(3!==t.length)throw new Jo("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!Oo.test(t[r]))throw new Jo("JWT not in base64url format");return{header:JSON.parse(Vo(t[0])),payload:JSON.parse(Vo(t[1])),signature:Xo(t[2]),raw:{header:t[0],payload:t[1]}}}function la(e){return("0"+e.toString(16)).substr(-2)}async function ca(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ua(e,t,r=!1){const n=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,la).join("")}();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await na(e,`${t}-code-verifier`,s);const i=await ca(n);return[i,n===i?"plain":"s256"]}oa.promiseConstructor=Promise;const da=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const ha=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),fa=[502,503,504];async function pa(e){var t,r;if(!("object"==typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"==typeof r.json))throw new Fo(ha(e),0);if(fa.includes(e.status))throw new Fo(ha(e),e.status);let n,s;try{n=await e.json()}catch(Va){throw new Io(ha(Va),Va)}const i=function(e){const t=e.headers.get(jo);if(!t)return null;if(!t.match(da))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(Va){return null}}(e);if(i&&i.getTime()>=Ro.timestamp&&"object"==typeof n&&n&&"string"==typeof n.code?s=n.code:"object"==typeof n&&n&&"string"==typeof n.error_code&&(s=n.error_code),s){if("weak_password"===s)throw new qo(ha(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===s)throw new Do}else if("object"==typeof n&&n&&"object"==typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new qo(ha(n),e.status,n.weak_password.reasons);throw new $o(ha(n),e.status||500,s)}async function ga(e,t,r,n){var s;const i=Object.assign({},null==n?void 0:n.headers);i[jo]||(i[jo]=Ro.name),(null==n?void 0:n.jwt)&&(i.Authorization=`Bearer ${n.jwt}`);const o=null!==(s=null==n?void 0:n.query)&&void 0!==s?s:{};(null==n?void 0:n.redirectTo)&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await async function(e,t,r,n,s,i){const o=((e,t,r,n)=>{const s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))})(t,n,s,i);let a;try{a=await e(r,Object.assign({},o))}catch(Va){throw console.error(Va),new Fo(ha(Va),0)}a.ok||await pa(a);if(null==n?void 0:n.noResolveJson)return a;try{return await a.json()}catch(Va){await pa(Va)}}(e,t,r+a,{headers:i,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function ma(e){var t;let r=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function va(e){const t=ma(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function ya(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ba(e){return{data:e,error:null}}function wa(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,o=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},user:Object.assign({},o)},error:null}}function _a(e){return e}class xa{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=ra(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await ga(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ao(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await ga(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ya})}catch(r){if(Ao(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r}(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await ga(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:wa,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Ao(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ga(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ya})}catch(t){if(Ao(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,s,i,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await ga(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(s=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==s?s:""},xform:_a});if(c.error)throw c.error;const u=await c.json(),d=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t})),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(Ao(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await ga(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ya})}catch(t){if(Ao(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await ga(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ya})}catch(r){if(Ao(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await ga(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ya})}catch(r){if(Ao(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await ga(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(Ao(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await ga(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ao(t))return{data:null,error:t};throw t}}}const ka={getItem:e=>ta()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{ta()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{ta()&&globalThis.localStorage.removeItem(e)}};function Sa(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Ea=!!(globalThis&&ta()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Ta extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ca extends Ta{}async function ja(e,t,r){Ea&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout((()=>{n.abort(),Ea&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},(async n=>{if(!n){if(0===t)throw Ea&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Ca(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ea)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(Va){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",Va)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}Ea&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{Ea&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(Va){"undefined"!=typeof self&&(self.globalThis=self)}}();const Ra={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Co,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Oa(e,t,r){return await r()}class Pa{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Pa.nextInstanceID,Pa.nextInstanceID+=1,this.instanceID>0&&Qo()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Ra),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new xa({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=ra(n.fetch),this.lock=n.lock||Oa,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Qo()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=ja:this.lock=Oa,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ta()?this.storage=ka:(this.memoryStorage={},this.storage=Sa(this.memoryStorage)):(this.memoryStorage={},this.storage=Sa(this.memoryStorage)),Qo()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(Va){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",Va)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${So}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach(((e,r)=>{t[r]=e}))}catch(Va){}return r.searchParams.forEach(((e,r)=>{t[r]=e})),t}(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Qo()&&this.detectSessionInUrl&&"none"!==r){const{data:n,error:s}=await this._getSessionFromURL(t,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),function(e){return Ao(e)&&"AuthImplicitGrantRedirectError"===e.name}(s)){const t=null===(e=s.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout((async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ao(t)?{error:t}:{error:new Io("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const s=await ga(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:ma}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const a=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(s){if(Ao(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,r,n;try{let s;if("email"in e){const{email:r,password:n,options:i}=e;let o=null,a=null;"pkce"===this.flowType&&([o,a]=await ua(this.storage,this.storageKey)),s=await ga(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:o,code_challenge_method:a},xform:ma})}else{if(!("phone"in e))throw new Mo("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:o}=e;s=await ga(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(r=null==o?void 0:o.data)&&void 0!==r?r:{},channel:null!==(n=null==o?void 0:o.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:ma})}}const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const a=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(s){if(Ao(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:n,options:s}=e;t=await ga(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:va})}else{if(!("phone"in e))throw new Mo("You must provide either an email or phone number and a password");{const{phone:r,password:n,options:s}=e;t=await ga(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:va})}}const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}):{data:{user:null,session:null},error:new Lo}}catch(t){if(Ao(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await sa(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/");try{const{data:t,error:s}=await ga(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ma});if(await ia(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:s}):{data:{user:null,session:null,redirectType:null},error:new Lo}}catch(s){if(Ao(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:s,nonce:i}=e,o=await ga(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:ma}),{data:a,error:l}=o;return l?{data:{user:null,session:null},error:l}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:l}):{data:{user:null,session:null},error:new Lo}}catch(t){if(Ao(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,s,i;try{if("email"in e){const{email:n,options:s}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await ua(this.storage,this.storageKey));const{error:a}=await ga(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},create_user:null===(r=null==s?void 0:s.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:i,code_challenge_method:o},redirectTo:null==s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:r}=e,{data:o,error:a}=await ga(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null==r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(s=null==r?void 0:r.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(i=null==r?void 0:r.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new Mo("You must provide either an email or phone number.")}catch(o){if(Ao(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let n,s;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,s=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:i,error:o}=await ga(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:ma});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const a=i.session,l=i.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(Ao(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let s=null,i=null;return"pkce"===this.flowType&&([s,i]=await ua(this.storage,this.storageKey)),await ga(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:ba})}catch(s){if(Ao(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Do;const{error:n}=await ga(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}}))}catch(e){if(Ao(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:s}=e,{error:i}=await ga(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},redirectTo:null==s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:r,type:n,options:s}=e,{data:i,error:o}=await ga(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o}}throw new Mo("You must provide either an email or phone number and a type")}catch(t){if(Ao(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(Va){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(Va){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await sa(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<To;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}const{session:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await ga(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ya}):await this._useSession((async e=>{var t,r,n;const{data:s,error:i}=e;if(i)throw i;return(null===(t=s.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await ga(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(r=s.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,xform:ya}):{data:{user:null},error:new Do}}))}catch(t){if(Ao(t))return function(e){return Ao(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await ia(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async r=>{const{data:n,error:s}=r;if(s)throw s;if(!n.session)throw new Do;const i=n.session;let o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await ua(this.storage,this.storageKey));const{data:l,error:c}=await ga(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:i.access_token,xform:ya});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}))}catch(r){if(Ao(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Do;const t=Date.now()/1e3;let r=t,n=!0,s=null;const{payload:i}=aa(e.access_token);if(i.exp&&(r=i.exp,n=r<=t),n){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};s=t}else{const{data:n,error:i}=await this._getUser(e.access_token);if(i)throw i;s={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(Ao(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var r;if(!e){const{data:n,error:s}=t;if(s)throw s;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new Do;const{session:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Ao(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Qo())throw new Uo("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Uo(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Bo("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Uo("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Bo("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:s,refresh_token:i,expires_in:o,expires_at:a,token_type:l}=e;if(!(s&&o&&i&&l))throw new Uo("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(o);let d=c+u;a&&(d=parseInt(a));const h=d-c;1e3*h<=Eo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${u}s`);const f=d-u;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,d,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,d,c);const{data:p,error:g}=await this._getUser(s);if(g)throw g;const m={provider_token:r,provider_refresh_token:n,access_token:s,expires_in:u,expires_at:d,refresh_token:i,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(r){if(Ao(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await sa(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var r;const{data:n,error:s}=t;if(s)return{error:s};const i=null===(r=n.session)||void 0===r?void 0:r.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return Ao(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await ia(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession((async t=>{var r,n;try{const{data:{session:n},error:s}=t;if(s)throw s;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(s){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}}))}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await ua(this.storage,this.storageKey,!0));try{return await ga(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(Ao(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ao(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession((async t=>{var r,n,s,i,o;const{data:a,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:!0});return await ga(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(i=a.session)||void 0===i?void 0:i.access_token)&&void 0!==o?o:void 0})}));if(n)throw n;return Qo()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(r){if(Ao(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var r,n;const{data:s,error:i}=t;if(i)throw i;return await ga(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(r=s.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})}))}catch(t){if(Ao(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await ga(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ma})),n=(e,t)=>{const r=200*Math.pow(2,e);return t&&zo(t)&&Date.now()+r-s<Eo},new Promise(((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await r(s);if(!n(s,null,t))return void e(t)}catch(Va){if(!n(s,Va))return void t(Va)}})()})))}catch(s){if(this._debug(t,"error",s),Ao(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}var r,n}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Qo()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await sa(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r))return this._debug(t,"session is not valid"),void(null!==r&&await this._removeSession());const n=1e3*(null!==(e=r.expires_at)&&void 0!==e?e:1/0)-Date.now()<To;if(this._debug(t,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),zo(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(t,"error",r),void console.error(r)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Do;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new oa;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new Do;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(s){if(this._debug(n,"error",s),Ao(s)){const e={session:null,error:s};return zo(s)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],s=Array.from(this.stateChangeEmitters.values()).map((async r=>{try{await r.callback(e,t)}catch(Va){n.push(Va)}}));if(await Promise.all(s),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await na(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await ia(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Qo()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(Va){console.error("removing visibilitychange callback failed",Va)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Eo);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const e=Date.now();try{return await this._useSession((async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*r.expires_at-e)/Eo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)}))}catch(Va){console.error("Auto refresh tick failed with error. This is likely a transient error.",Va)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(Va){if(!(Va.isAcquireTimeout||Va instanceof Ta))throw Va;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qo()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){const[e,t]=await ua(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var r;const{data:n,error:s}=t;return s?{data:null,error:s}:await ga(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})}))}catch(t){if(Ao(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var r,n;const{data:s,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:l}=await ga(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(n=null==a?void 0:a.totp)||void 0===n?void 0:n.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})}))}catch(t){if(Ao(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var r;const{data:n,error:s}=t;if(s)return{data:null,error:s};const{data:i,error:o}=await ga(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})}))}catch(t){if(Ao(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var r;const{data:n,error:s}=t;return s?{data:null,error:s}:await ga(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})}))}catch(t){if(Ao(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null==e?void 0:e.factors)||[],n=r.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),s=r.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:r,totp:n,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,r;const{data:{session:n},error:s}=e;if(s)return{data:null,error:s};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=aa(n.access_token);let o=null;i.aal&&(o=i.aal);let a=o;(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==r?r:[]).length>0&&(a="aal2");return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:i.amr||[]},error:null}}))))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find((t=>t.kid===e));if(r)return r;if(r=this.jwks.keys.find((t=>t.kid===e)),r&&this.jwks_cached_at+6e5>Date.now())return r;const{data:n,error:s}=await ga(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!n.keys||0===n.keys.length)throw new Jo("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),r=n.keys.find((t=>t.kid===e)),!r)throw new Jo("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}const{header:n,payload:s,signature:i,raw:{header:o,payload:a}}=aa(r);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(s.exp),!n.kid||"HS256"===n.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:s,header:n,signature:i},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),c=await this.fetchJwk(n.kid,t),u=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!(await crypto.subtle.verify(l,u,i,Zo(`${o}.${a}`))))throw new Jo("Invalid JWT signature");return{data:{claims:s,header:n,signature:i},error:null}}catch(r){if(Ao(r))return{data:null,error:r};throw r}}}Pa.nextInstanceID=0;const Aa=Pa;class $a extends Aa{constructor(e){super(e)}}var Ia=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(Va){i(Va)}}function a(e){try{l(n.throw(e))}catch(Va){i(Va)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class Na{constructor(e,t,r){var n,s,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=e.replace(/\/$/,"");this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:r,auth:n,realtime:s,global:i}=e,{db:o,auth:a,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>ko(this,void 0,void 0,(function*(){return""}))};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!=r?r:{},{db:yo,realtime:wo,auth:Object.assign(Object.assign({},bo),{storageKey:a}),global:vo});this.storageKey=null!==(n=l.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(s=l.global.headers)&&void 0!==s?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=l.auth)&&void 0!==i?i:{},this.headers,l.global.fetch),this.fetch=xo(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new ri(`${o}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new fs(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new go(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ia(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:s,flowType:i,lock:o,debug:a},l,c){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $a({url:this.authUrl,headers:Object.assign(Object.assign({},u),l),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:i,lock:o,debug:a,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Ki(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=r}}const Da="https://jgbzhzztdcoygkayqzrp.supabase.co",La="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnYnpoenp0ZGNveWdrYXlxenJwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE5NjcwMTMsImV4cCI6MjA1NzU0MzAxM30.81T3t8679uNFkRq6CcFfB8XZG277VO074P05g9jKb7M";console.log("Supabase initialization:",{url:Da,hasAnonKey:!0,env:"production",base:"/request-text/"});const Ma=new Na(Da,La,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});Ma.auth.onAuthStateChange(((e,t)=>{var r;console.log("Supabase auth state changed:",{event:e,email:null==(r=null==t?void 0:t.user)?void 0:r.email,path:window.location.pathname})}));function Ua(){const t=Ce();return e.useEffect((()=>{(async()=>{try{const{data:{session:e},error:r}=await Ma.auth.getSession();if(r)return console.error("Auth callback error:",r),void t("/",{replace:!0});(null==e?void 0:e.user)?("tocotoco2674@gmail.com"===e.user.email||(console.log("Unauthorized email in callback:",e.user.email),await Ma.auth.signOut()),t("/",{replace:!0})):t("/",{replace:!0})}catch(e){console.error("Callback error:",e),t("/",{replace:!0})}})()}),[t]),T.jsx("div",{className:"min-h-screen flex items-center justify-center",children:T.jsxs("div",{className:"text-center",children:[T.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"èªè¨¼ä¸­..."}),T.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"})]})})}const Ba="tocotoco2674@gmail.com",Fa=e.createContext(void 0);function za({children:t}){const[r,n]=e.useState(null),[s,i]=e.useState(!0),[o,a]=e.useState(null),l=async e=>{console.log("Handling session:",e),(null==e?void 0:e.user)?e.user.email===Ba?(console.log("Authorized user:",e.user.email),n(e.user),a(null)):(console.log("Unauthorized email:",e.user.email),n(null),a("ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚"),await Ma.auth.signOut()):(console.log("No session found"),n(null),a(null)),i(!1)};e.useEffect((()=>{console.log("Initializing auth state"),Ma.auth.getSession().then((({data:{session:e}})=>{l(e)}));const{data:{subscription:e}}=Ma.auth.onAuthStateChange(((e,t)=>{console.log("Auth state changed:",e),l(t)}));return()=>e.unsubscribe()}),[]);return T.jsx(Fa.Provider,{value:{user:r,loading:s,signInWithGoogle:async()=>{a(null);try{const{data:e,error:t}=await Ma.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/request-text/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});if(t)throw t;const{data:{session:r}}=await Ma.auth.getSession();(null==r?void 0:r.user)&&r.user.email!==Ba&&(a("ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚"),await Ma.auth.signOut())}catch(e){a(e instanceof Error?e.message:"èªè¨¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚")}},signOut:async()=>{try{const{error:e}=await Ma.auth.signOut();if(e)throw e;n(null),a(null)}catch(e){a(e instanceof Error?e.message:"ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚")}},error:o},children:t})}function qa(){const t=e.useContext(Fa);if(void 0===t)throw new Error("useAuth must be used within an AuthProvider");return t}const Ja=[{name:"Title",type:"string",description:"ã‚¿ã‚¤ãƒˆãƒ«ã¾ãŸã¯ä»¶å"},{name:"Date_start",type:"date",description:"é–‹å§‹æ—¥ï¼ˆYYYY-MM-DDå½¢å¼ï¼‰"},{name:"Date_end",type:"date",description:"çµ‚äº†æ—¥ï¼ˆYYYY-MM-DDå½¢å¼ï¼‰"},{name:"requester",type:"string",description:"ä¾é ¼è€…å"}],Ka="/request-text/text_analyzer_structure";function Wa({children:e}){const{user:t,loading:r,error:n,signInWithGoogle:s}=qa(),i=Se();return r?T.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:T.jsxs("div",{className:"text-center",children:[T.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"èª­ã¿è¾¼ã¿ä¸­..."}),T.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"})]})}):t?T.jsx(T.Fragment,{children:e}):(console.log("Current pathname:",i.pathname),i.pathname.includes("/auth/callback")?T.jsx(T.Fragment,{children:e}):T.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:T.jsxs("div",{className:"text-center",children:[T.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Text Structure Analyzer"}),T.jsx("p",{className:"text-gray-600 mb-8",children:"ã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚"}),n&&T.jsx("p",{className:"text-red-600 mb-4",children:n}),T.jsx("button",{onClick:s,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Googleã§ãƒ­ã‚°ã‚¤ãƒ³"})]})}))}function Ha(){const[t,r]=e.useState("analyze"),[n,s]=e.useState(Ja),{signOut:i}=qa();return e.useEffect((()=>{try{console.log("Loading structure from:",Ka);const e=localStorage.getItem(Ka);if(console.log("Loaded structure:",e),e){const t=JSON.parse(e);s(t),console.log("Successfully loaded and parsed structure")}else console.log("No saved structure found, using default")}catch(e){console.error("Failed to load saved structure:",e),s(Ja)}}),[]),e.useEffect((()=>{try{console.log("Saving structure to:",Ka),localStorage.setItem(Ka,JSON.stringify(n)),console.log("Successfully saved structure")}catch(e){console.error("Failed to save structure:",e)}}),[n]),T.jsxs("div",{className:"min-h-screen bg-gray-50",children:[T.jsx("header",{className:"bg-white shadow-sm",children:T.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:T.jsxs("div",{className:"flex justify-between h-16 items-center",children:[T.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Text Structure Analyzer"}),T.jsxs("div",{className:"flex items-center space-x-4",children:[T.jsxs("nav",{className:"flex space-x-4",children:[T.jsxs("button",{onClick:()=>r("structure"),className:"px-3 py-2 rounded-md "+("structure"===t?"bg-gray-900 text-white":"text-gray-700 hover:bg-gray-100")+" flex items-center gap-2",children:[T.jsx(h,{size:20}),"Structure"]}),T.jsxs("button",{onClick:()=>r("analyze"),className:"px-3 py-2 rounded-md "+("analyze"===t?"bg-gray-900 text-white":"text-gray-700 hover:bg-gray-100")+" flex items-center gap-2",children:[T.jsx(f,{size:20}),"Analyze"]}),T.jsxs("button",{onClick:()=>r("settings"),className:"px-3 py-2 rounded-md "+("settings"===t?"bg-gray-900 text-white":"text-gray-700 hover:bg-gray-100")+" flex items-center gap-2",children:[T.jsx(p,{size:20}),"API Settings"]})]}),T.jsxs("button",{onClick:()=>i(),className:"px-3 py-2 rounded-md text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[T.jsx(g,{size:20}),"ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ"]})]})]})})}),T.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["structure"===t&&T.jsx(ts,{structure:n,setStructure:s}),"analyze"===t&&T.jsx(rs,{structure:n}),"settings"===t&&T.jsx(ns,{})]})]})}function Ga(){return T.jsx(ct,{basename:"/request-text",children:T.jsx(za,{children:T.jsxs(Fe,{children:[T.jsx(Ue,{path:"/auth/callback",element:T.jsx(Wa,{children:T.jsx(Ua,{})})}),T.jsx(Ue,{path:"/",element:T.jsx(Wa,{children:T.jsx(Ha,{})})}),T.jsx(Ue,{path:"*",element:T.jsx(Me,{to:"/",replace:!0})})]})})})}E(document.getElementById("root")).render(T.jsx(e.StrictMode,{children:T.jsx(Ga,{})}));
